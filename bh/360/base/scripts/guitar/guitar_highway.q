button_up_models = [
	{
		green = {
			name = button_g
			name_string = 'button_g'
			scale = 1.0
			scale_5d = -1.0
			scale_4d = -1.0
			material_lip = Mat_NB_Green_rim_POS1
			material_mid = Mat_NB_Green_Cup_POS1
			material_head = Mat_NB_Green_Cap_POS1
			material_head_lit = Mat_NB_Green_Cap_LIT_POS1
			material_neck = Mat_NB_Neck
			material_down = Mat_NB_Green_Cup_DWN_POS1
			material_5d_lip = Mat_NB_5D_Green_rim_POS1
			material_5d_mid = Mat_NB_5D_Green_Cup_POS1
			material_5d_head = Mat_NB_5D_Green_Cap_POS1
			material_5d_head_lit = Mat_NB_5D_Green_Cap_LIT_POS1
			material_5d_neck = Mat_NB_Neck
			material_5d_down = Mat_NB_5D_Green_Cup_DWN_POS1
			material_4d_lip = Mat_NB_4D_Green_rim_POS1
			material_4d_mid = Mat_NB_4D_Green_Cup_POS1
			material_4d_head = Mat_NB_4D_Green_Cap_POS1
			material_4d_head_lit = Mat_NB_4D_Green_Cap_LIT_POS1
			material_4d_neck = Mat_NB_Neck
			material_4d_down = Mat_NB_4D_Green_Cup_DWN_POS1
			material_open_lit = Mat_NB_Purple_Cap_LIT_POS1
			material_5d_open_lit = Mat_NB_Purple_Cap_LIT_POS1
			material_4d_open_lit = Mat_NB_Purple_Cap_LIT_POS1
		}
		red = {
			name = button_r
			name_string = 'button_r'
			scale = 1.0
			scale_5d = 1.0
			scale_4d = 1.0
			material_lip = Mat_NB_Red_rim_POS2
			material_mid = Mat_NB_RED_Cup_POS2
			material_head = Mat_NB_Red_Cap_POS2
			material_head_lit = Mat_NB_Red_Cap_LIT_POS2
			material_neck = Mat_NB_Neck
			material_down = Mat_NB_RED_Cup_DWN_POS2
			material_5d_lip = Mat_NB_5D_Red_rim_POS1
			material_5d_mid = Mat_NB_5D_Red_Cup_POS1
			material_5d_head = Mat_NB_5D_Red_Cap_POS1
			material_5d_head_lit = Mat_NB_5D_Red_Cap_LIT_POS1
			material_5d_neck = Mat_NB_Neck
			material_5d_down = Mat_NB_5D_Red_Cup_DWN_POS1
			material_4d_lip = Mat_NB_4D_Red_rim_POS1
			material_4d_mid = Mat_NB_4D_Red_Cup_POS1
			material_4d_head = Mat_NB_4D_Red_Cap_POS1
			material_4d_head_lit = Mat_NB_4D_Red_Cap_LIT_POS1
			material_4d_neck = Mat_NB_Neck
			material_4d_down = Mat_NB_4D_Red_Cup_DWN_POS1
			material_open_lit = Mat_NB_Purple_Cap_LIT_POS2
			material_5d_open_lit = Mat_NB_Purple_Cap_LIT_POS1
			material_4d_open_lit = Mat_NB_Purple_Cap_LIT_POS1
		}
		yellow = {
			name = button_y
			name_string = 'button_y'
			scale = 1.0
			scale_5d = 1.0
			scale_4d = 1.0
			material_lip = Mat_NB_Yellow_rim_POS3
			material_mid = Mat_NB_Yellow_Cup_POS3
			material_head = Mat_NB_Yellow_Cap_POS3
			material_head_lit = Mat_NB_Yellow_Cap_LIT_POS3
			material_neck = Mat_NB_Neck
			material_down = Mat_NB_Yellow_Cup_DWN_POS3
			material_5d_lip = Mat_NB_5D_Yellow_rim_POS2
			material_5d_mid = Mat_NB_5D_Yellow_Cup_POS2
			material_5d_head = Mat_NB_5D_Yellow_Cap_POS2
			material_5d_head_lit = Mat_NB_5D_Yellow_Cap_LIT_POS2
			material_5d_neck = Mat_NB_Neck
			material_5d_down = Mat_NB_5D_Yellow_Cup_DWN_POS2
			material_4d_lip = Mat_NB_4D_Yellow_rim_POS2
			material_4d_mid = Mat_NB_4D_Yellow_Cup_POS2
			material_4d_head = Mat_NB_4D_Yellow_Cap_POS2
			material_4d_head_lit = Mat_NB_4D_Yellow_Cap_LIT_POS2
			material_4d_neck = Mat_NB_Neck
			material_4d_down = Mat_NB_4D_Yellow_Cup_DWN_POS2
			material_open_lit = Mat_NB_Purple_Cap_LIT_POS3
			material_5d_open_lit = Mat_NB_Purple_Cap_LIT_POS2
			material_4d_open_lit = Mat_NB_Purple_Cap_LIT_POS2
		}
		blue = {
			name = button_b
			name_string = 'button_b'
			scale = -1.0
			scale_5d = 1.0
			scale_4d = -1.0
			material_lip = Mat_NB_Blue_rim_POS2
			material_mid = Mat_NB_Blue_Cup_POS2
			material_head = Mat_NB_Blue_Cap_POS2
			material_head_lit = Mat_NB_Blue_Cap_LIT_POS2
			material_neck = Mat_NB_Neck
			material_down = Mat_NB_Blue_Cup_DWN_POS2
			material_5d_lip = Mat_NB_5D_Blue_rim_POS3
			material_5d_mid = Mat_NB_5D_Blue_Cup_POS3
			material_5d_head = Mat_NB_5D_Blue_Cap_POS3
			material_5d_head_lit = Mat_NB_5D_Blue_Cap_LIT_POS3
			material_5d_neck = Mat_NB_Neck
			material_5d_down = Mat_NB_5D_Blue_Cup_DWN_POS3
			material_4d_lip = Mat_NB_4D_Blue_rim_POS2
			material_4d_mid = Mat_NB_4D_Blue_Cup_POS2
			material_4d_head = Mat_NB_4D_Blue_Cap_POS2
			material_4d_head_lit = Mat_NB_4D_Blue_Cap_LIT_POS2
			material_4d_neck = Mat_NB_Neck
			material_4d_down = Mat_NB_4D_Blue_Cup_DWN_POS2
			material_open_lit = Mat_NB_Purple_Cap_LIT_POS2
			material_5d_open_lit = Mat_NB_Purple_Cap_LIT_POS3
			material_4d_open_lit = Mat_NB_Purple_Cap_LIT_POS2
		}
		orange = {
			name = button_o
			name_string = 'button_o'
			scale = -1.0
			scale_5d = -1.0
			scale_4d = -1.0
			material_lip = Mat_NB_Orange_rim_POS1
			material_mid = Mat_NB_Orange_Cup_POS1
			material_head = Mat_NB_Orange_Cap_POS1
			material_head_lit = Mat_NB_Orange_Cap_LIT_POS1
			material_neck = Mat_NB_Neck
			material_down = Mat_NB_Orange_Cup_DWN_POS1
			material_5d_lip = Mat_NB_5D_Orange_rim_POS2
			material_5d_mid = Mat_NB_5D_Orange_Cup_POS2
			material_5d_head = Mat_NB_5D_Orange_Cap_POS2
			material_5d_head_lit = Mat_NB_5D_Orange_Cap_LIT_POS2
			material_5d_neck = Mat_NB_Neck
			material_5d_down = Mat_NB_5D_Orange_Cup_DWN_POS2
			material_4d_lip = Mat_NB_4D_Green_rim_POS1
			material_4d_mid = Mat_NB_4D_Green_Cup_POS1
			material_4d_head = Mat_NB_4D_Green_Cap_POS1
			material_4d_head_lit = Mat_NB_4D_Green_Cap_LIT_POS1
			material_4d_neck = Mat_NB_Neck
			material_4d_down = Mat_NB_4D_Green_Cup_DWN_POS1
			material_open_lit = Mat_NB_Purple_Cap_LIT_POS1
			material_5d_open_lit = Mat_NB_Purple_Cap_LIT_POS2
			material_4d_open_lit = Mat_NB_Purple_Cap_LIT_POS1
		}
		white = {
			name = button_w
			name_string = 'button_w'
			scale = 1.0
			scale_5d = 1.0
			scale_4d = 1.0
			material_lip = Mat_Placeholder
			material_mid = Mat_Placeholder
			material_head = Mat_Placeholder
			material_head_lit = Mat_Placeholder
			material_neck = Mat_Placeholder
			material_down = Mat_Placeholder
			material_5d_lip = Mat_Placeholder
			material_5d_mid = Mat_Placeholder
			material_5d_head = Mat_Placeholder
			material_5d_head_lit = Mat_Placeholder
			material_5d_neck = Mat_Placeholder
			material_5d_down = Mat_Placeholder
			material_4d_lip = Mat_Placeholder
			material_4d_mid = Mat_Placeholder
			material_4d_head = Mat_Placeholder
			material_4d_head_lit = Mat_Placeholder
			material_4d_neck = Mat_Placeholder
			material_4d_down = Mat_Placeholder
			material_open_lit = Mat_Placeholder
			material_5d_open_lit = Mat_Placeholder
			material_4d_open_lit = Mat_Placeholder
		}
		extra = {
			name = button_x
			name_string = 'button_x'
			scale = 1.0
			scale_5d = 1.0
			scale_4d = 1.0
			material_lip = sys_NowBar_Button01_Blue_Lip_sys_NowBar_Button01_Blue_Lip
			material_mid = sys_NowBar_Button01_Blue_Mid2_sys_NowBar_Button01_Blue_Mid2
			material_head = sys_NowBar_Head_Blue_sys_NowBar_Head_Blue
			material_head_lit = sys_NowBar_Head_BlueL_sys_NowBar_Head_BlueL
			material_neck = sys_NowBar_Neck01_sys_NowBar_Neck01
			material_down = sys_NowBar_Button01_Blue_Down_sys_NowBar_Button01_Blue_Down
			material_5d_lip = sys_NowBar_Button01_Blue_Lip_sys_NowBar_Button01_Blue_Lip
			material_5d_mid = sys_NowBar_Button01_Blue_Mid2_sys_NowBar_Button01_Blue_Mid2
			material_5d_head = sys_NowBar_Head_Blue_sys_NowBar_Head_Blue
			material_5d_head_lit = sys_NowBar_Head_BlueL_sys_NowBar_Head_BlueL
			material_5d_neck = sys_NowBar_Neck01_sys_NowBar_Neck01
			material_5d_down = sys_NowBar_Button01_Blue_Down_sys_NowBar_Button01_Blue_Down
			material_4d_lip = sys_NowBar_Button01_Blue_Lip_sys_NowBar_Button01_Blue_Lip
			material_4d_mid = sys_NowBar_Button01_Blue_Mid2_sys_NowBar_Button01_Blue_Mid2
			material_4d_head = sys_NowBar_Head_Blue_sys_NowBar_Head_Blue
			material_4d_head_lit = sys_NowBar_Head_BlueL_sys_NowBar_Head_BlueL
			material_4d_neck = sys_NowBar_Neck01_sys_NowBar_Neck01
			material_4d_down = sys_NowBar_Button01_Blue_Down_sys_NowBar_Button01_Blue_Down
			material_open_lit = sys_NowBar_Head_BlueL_sys_NowBar_Head_BlueL
			material_5d_open_lit = sys_NowBar_Head_BlueL_sys_NowBar_Head_BlueL
			material_4d_open_lit = sys_NowBar_Head_BlueL_sys_NowBar_Head_BlueL
		}
	}
	{
		green = {
			name = button_g
			name_string = 'button_g'
			scale = 1.0
			scale_5d = -1.0
			scale_4d = -1.0
			material_lip = Mat_NB_Green_rim_POS1
			material_mid = Mat_NB_Green_Cup_POS1
			material_head = Mat_NB_Green_Cap_POS1
			material_head_lit = Mat_NB_Green_Cap_LIT_POS1
			material_neck = Mat_NB_Neck
			material_down = Mat_NB_Green_Cup_DWN_POS1
			material_5d_lip = Mat_NB_5D_Green_rim_POS1
			material_5d_mid = Mat_NB_5D_Green_Cup_POS1
			material_5d_head = Mat_NB_5D_Green_Cap_POS1
			material_5d_head_lit = Mat_NB_5D_Green_Cap_LIT_POS1
			material_5d_neck = Mat_NB_Neck
			material_5d_down = Mat_NB_5D_Green_Cup_DWN_POS1
			material_4d_lip = Mat_NB_4D_Green_rim_POS1
			material_4d_mid = Mat_NB_4D_Green_Cup_POS1
			material_4d_head = Mat_NB_4D_Green_Cap_POS1
			material_4d_head_lit = Mat_NB_4D_Green_Cap_LIT_POS1
			material_4d_neck = Mat_NB_Neck
			material_4d_down = Mat_NB_4D_Green_Cup_DWN_POS1
			material_open_lit = Mat_NB_Purple_Cap_LIT_POS1
			material_5d_open_lit = Mat_NB_Purple_Cap_LIT_POS1
			material_4d_open_lit = Mat_NB_Purple_Cap_LIT_POS1
		}
		red = {
			name = button_r
			name_string = 'button_r'
			scale = 1.0
			scale_5d = 1.0
			scale_4d = 1.0
			material_lip = Mat_NB_Red_rim_POS2
			material_mid = Mat_NB_RED_Cup_POS2
			material_head = Mat_NB_Red_Cap_POS2
			material_head_lit = Mat_NB_Red_Cap_LIT_POS2
			material_neck = Mat_NB_Neck
			material_down = Mat_NB_RED_Cup_DWN_POS2
			material_5d_lip = Mat_NB_5D_Red_rim_POS1
			material_5d_mid = Mat_NB_5D_Red_Cup_POS1
			material_5d_head = Mat_NB_5D_Red_Cap_POS1
			material_5d_head_lit = Mat_NB_5D_Red_Cap_LIT_POS1
			material_5d_neck = Mat_NB_Neck
			material_5d_down = Mat_NB_5D_Red_Cup_DWN_POS1
			material_4d_lip = Mat_NB_4D_Red_rim_POS1
			material_4d_mid = Mat_NB_4D_Red_Cup_POS1
			material_4d_head = Mat_NB_4D_Red_Cap_POS1
			material_4d_head_lit = Mat_NB_4D_Red_Cap_LIT_POS1
			material_4d_neck = Mat_NB_Neck
			material_4d_down = Mat_NB_4D_Red_Cup_DWN_POS1
			material_open_lit = Mat_NB_Purple_Cap_LIT_POS2
			material_5d_open_lit = Mat_NB_Purple_Cap_LIT_POS1
			material_4d_open_lit = Mat_NB_Purple_Cap_LIT_POS1
		}
		yellow = {
			name = button_y
			name_string = 'button_y'
			scale = 1.0
			scale_5d = 1.0
			scale_4d = 1.0
			material_lip = Mat_NB_Yellow_rim_POS3
			material_mid = Mat_NB_Yellow_Cup_POS3
			material_head = Mat_NB_Yellow_Cap_POS3
			material_head_lit = Mat_NB_Yellow_Cap_LIT_POS3
			material_neck = Mat_NB_Neck
			material_down = Mat_NB_Yellow_Cup_DWN_POS3
			material_5d_lip = Mat_NB_5D_Yellow_rim_POS2
			material_5d_mid = Mat_NB_5D_Yellow_Cup_POS2
			material_5d_head = Mat_NB_5D_Yellow_Cap_POS2
			material_5d_head_lit = Mat_NB_5D_Yellow_Cap_LIT_POS2
			material_5d_neck = Mat_NB_Neck
			material_5d_down = Mat_NB_5D_Yellow_Cup_DWN_POS2
			material_4d_lip = Mat_NB_4D_Yellow_rim_POS2
			material_4d_mid = Mat_NB_4D_Yellow_Cup_POS2
			material_4d_head = Mat_NB_4D_Yellow_Cap_POS2
			material_4d_head_lit = Mat_NB_4D_Yellow_Cap_LIT_POS2
			material_4d_neck = Mat_NB_Neck
			material_4d_down = Mat_NB_4D_Yellow_Cup_DWN_POS2
			material_open_lit = Mat_NB_Purple_Cap_LIT_POS3
			material_5d_open_lit = Mat_NB_Purple_Cap_LIT_POS2
			material_4d_open_lit = Mat_NB_Purple_Cap_LIT_POS2
		}
		blue = {
			name = button_b
			name_string = 'button_b'
			scale = -1.0
			scale_5d = 1.0
			scale_4d = -1.0
			material_lip = Mat_NB_Blue_rim_POS2
			material_mid = Mat_NB_Blue_Cup_POS2
			material_head = Mat_NB_Blue_Cap_POS2
			material_head_lit = Mat_NB_Blue_Cap_LIT_POS2
			material_neck = Mat_NB_Neck
			material_down = Mat_NB_Blue_Cup_DWN_POS2
			material_5d_lip = Mat_NB_5D_Blue_rim_POS3
			material_5d_mid = Mat_NB_5D_Blue_Cup_POS3
			material_5d_head = Mat_NB_5D_Blue_Cap_POS3
			material_5d_head_lit = Mat_NB_5D_Blue_Cap_LIT_POS3
			material_5d_neck = Mat_NB_Neck
			material_5d_down = Mat_NB_5D_Blue_Cup_DWN_POS3
			material_4d_lip = Mat_NB_4D_Blue_rim_POS2
			material_4d_mid = Mat_NB_4D_Blue_Cup_POS2
			material_4d_head = Mat_NB_4D_Blue_Cap_POS2
			material_4d_head_lit = Mat_NB_4D_Blue_Cap_LIT_POS2
			material_4d_neck = Mat_NB_Neck
			material_4d_down = Mat_NB_4D_Blue_Cup_DWN_POS2
			material_open_lit = Mat_NB_Purple_Cap_LIT_POS2
			material_5d_open_lit = Mat_NB_Purple_Cap_LIT_POS3
			material_4d_open_lit = Mat_NB_Purple_Cap_LIT_POS2
		}
		orange = {
			name = button_o
			name_string = 'button_o'
			scale = -1.0
			scale_5d = -1.0
			scale_4d = -1.0
			material_lip = Mat_NB_Orange_rim_POS1
			material_mid = Mat_NB_Orange_Cup_POS1
			material_head = Mat_NB_Orange_Cap_POS1
			material_head_lit = Mat_NB_Orange_Cap_LIT_POS1
			material_neck = Mat_NB_Neck
			material_down = Mat_NB_Orange_Cup_DWN_POS1
			material_5d_lip = Mat_NB_5D_Orange_rim_POS2
			material_5d_mid = Mat_NB_5D_Orange_Cup_POS2
			material_5d_head = Mat_NB_5D_Orange_Cap_POS2
			material_5d_head_lit = Mat_NB_5D_Orange_Cap_LIT_POS2
			material_5d_neck = Mat_NB_Neck
			material_5d_down = Mat_NB_5D_Orange_Cup_DWN_POS2
			material_4d_lip = Mat_NB_4D_Green_rim_POS1
			material_4d_mid = Mat_NB_4D_Green_Cup_POS1
			material_4d_head = Mat_NB_4D_Green_Cap_POS1
			material_4d_head_lit = Mat_NB_4D_Green_Cap_LIT_POS1
			material_4d_neck = Mat_NB_Neck
			material_4d_down = Mat_NB_4D_Green_Cup_DWN_POS1
			material_open_lit = Mat_NB_Purple_Cap_LIT_POS1
			material_5d_open_lit = Mat_NB_Purple_Cap_LIT_POS2
			material_4d_open_lit = Mat_NB_Purple_Cap_LIT_POS1
		}
		white = {
			name = button_w
			name_string = 'button_w'
			scale = 1.0
			scale_5d = 1.0
			scale_4d = 1.0
			material_lip = Mat_Placeholder
			material_mid = Mat_Placeholder
			material_head = Mat_Placeholder
			material_head_lit = Mat_Placeholder
			material_neck = Mat_Placeholder
			material_down = Mat_Placeholder
			material_5d_lip = Mat_Placeholder
			material_5d_mid = Mat_Placeholder
			material_5d_head = Mat_Placeholder
			material_5d_head_lit = Mat_Placeholder
			material_5d_neck = Mat_Placeholder
			material_5d_down = Mat_Placeholder
			material_4d_lip = Mat_Placeholder
			material_4d_mid = Mat_Placeholder
			material_4d_head = Mat_Placeholder
			material_4d_head_lit = Mat_Placeholder
			material_4d_neck = Mat_Placeholder
			material_4d_down = Mat_Placeholder
			material_open_lit = Mat_Placeholder
			material_5d_open_lit = Mat_Placeholder
			material_4d_open_lit = Mat_Placeholder
		}
		extra = {
			name = button_x
			name_string = 'button_x'
			scale = 1.0
			scale_5d = 1.0
			scale_4d = 1.0
			material_lip = sys_NowBar_Button01_Blue_Lip_sys_NowBar_Button01_Blue_Lip
			material_mid = sys_NowBar_Button01_Blue_Mid2_sys_NowBar_Button01_Blue_Mid2
			material_head = sys_NowBar_Head_Blue_sys_NowBar_Head_Blue
			material_head_lit = sys_NowBar_Head_BlueL_sys_NowBar_Head_BlueL
			material_neck = sys_NowBar_Neck01_sys_NowBar_Neck01
			material_down = sys_NowBar_Button01_Blue_Down_sys_NowBar_Button01_Blue_Down
			material_5d_lip = sys_NowBar_Button01_Blue_Lip_sys_NowBar_Button01_Blue_Lip
			material_5d_mid = sys_NowBar_Button01_Blue_Mid2_sys_NowBar_Button01_Blue_Mid2
			material_5d_head = sys_NowBar_Head_Blue_sys_NowBar_Head_Blue
			material_5d_head_lit = sys_NowBar_Head_BlueL_sys_NowBar_Head_BlueL
			material_5d_neck = sys_NowBar_Neck01_sys_NowBar_Neck01
			material_5d_down = sys_NowBar_Button01_Blue_Down_sys_NowBar_Button01_Blue_Down
			material_4d_lip = sys_NowBar_Button01_Blue_Lip_sys_NowBar_Button01_Blue_Lip
			material_4d_mid = sys_NowBar_Button01_Blue_Mid2_sys_NowBar_Button01_Blue_Mid2
			material_4d_head = sys_NowBar_Head_Blue_sys_NowBar_Head_Blue
			material_4d_head_lit = sys_NowBar_Head_BlueL_sys_NowBar_Head_BlueL
			material_4d_neck = sys_NowBar_Neck01_sys_NowBar_Neck01
			material_4d_down = sys_NowBar_Button01_Blue_Down_sys_NowBar_Button01_Blue_Down
			material_open_lit = sys_NowBar_Head_BlueL_sys_NowBar_Head_BlueL
			material_5d_open_lit = sys_NowBar_Head_BlueL_sys_NowBar_Head_BlueL
			material_4d_open_lit = sys_NowBar_Head_BlueL_sys_NowBar_Head_BlueL
		}
	}
	{
		green = {
			name = button_g
			name_string = 'button_g'
			scale = 1.0
			scale_5d = -1.0
			scale_4d = -1.0
			material_lip = Mat_NB_Green_rim_POS1
			material_mid = Mat_NB_Green_Cup_POS1
			material_head = Mat_NB_Green_Cap_POS1
			material_head_lit = Mat_NB_Green_Cap_LIT_POS1
			material_neck = Mat_NB_Neck
			material_down = Mat_NB_Green_Cup_DWN_POS1
			material_5d_lip = Mat_NB_5D_Green_rim_POS1
			material_5d_mid = Mat_NB_5D_Green_Cup_POS1
			material_5d_head = Mat_NB_5D_Green_Cap_POS1
			material_5d_head_lit = Mat_NB_5D_Green_Cap_LIT_POS1
			material_5d_neck = Mat_NB_Neck
			material_5d_down = Mat_NB_5D_Green_Cup_DWN_POS1
			material_4d_lip = Mat_NB_4D_Green_rim_POS1
			material_4d_mid = Mat_NB_4D_Green_Cup_POS1
			material_4d_head = Mat_NB_4D_Green_Cap_POS1
			material_4d_head_lit = Mat_NB_4D_Green_Cap_LIT_POS1
			material_4d_neck = Mat_NB_Neck
			material_4d_down = Mat_NB_4D_Green_Cup_DWN_POS1
			material_open_lit = Mat_NB_Purple_Cap_LIT_POS1
			material_5d_open_lit = Mat_NB_Purple_Cap_LIT_POS1
			material_4d_open_lit = Mat_NB_Purple_Cap_LIT_POS1
		}
		red = {
			name = button_r
			name_string = 'button_r'
			scale = 1.0
			scale_5d = 1.0
			scale_4d = 1.0
			material_lip = Mat_NB_Red_rim_POS2
			material_mid = Mat_NB_RED_Cup_POS2
			material_head = Mat_NB_Red_Cap_POS2
			material_head_lit = Mat_NB_Red_Cap_LIT_POS2
			material_neck = Mat_NB_Neck
			material_down = Mat_NB_RED_Cup_DWN_POS2
			material_5d_lip = Mat_NB_5D_Red_rim_POS1
			material_5d_mid = Mat_NB_5D_Red_Cup_POS1
			material_5d_head = Mat_NB_5D_Red_Cap_POS1
			material_5d_head_lit = Mat_NB_5D_Red_Cap_LIT_POS1
			material_5d_neck = Mat_NB_Neck
			material_5d_down = Mat_NB_5D_Red_Cup_DWN_POS1
			material_4d_lip = Mat_NB_4D_Red_rim_POS1
			material_4d_mid = Mat_NB_4D_Red_Cup_POS1
			material_4d_head = Mat_NB_4D_Red_Cap_POS1
			material_4d_head_lit = Mat_NB_4D_Red_Cap_LIT_POS1
			material_4d_neck = Mat_NB_Neck
			material_4d_down = Mat_NB_4D_Red_Cup_DWN_POS1
			material_open_lit = Mat_NB_Purple_Cap_LIT_POS2
			material_5d_open_lit = Mat_NB_Purple_Cap_LIT_POS1
			material_4d_open_lit = Mat_NB_Purple_Cap_LIT_POS1
		}
		yellow = {
			name = button_y
			name_string = 'button_y'
			scale = 1.0
			scale_5d = 1.0
			scale_4d = 1.0
			material_lip = Mat_NB_Yellow_rim_POS3
			material_mid = Mat_NB_Yellow_Cup_POS3
			material_head = Mat_NB_Yellow_Cap_POS3
			material_head_lit = Mat_NB_Yellow_Cap_LIT_POS3
			material_neck = Mat_NB_Neck
			material_down = Mat_NB_Yellow_Cup_DWN_POS3
			material_5d_lip = Mat_NB_5D_Yellow_rim_POS2
			material_5d_mid = Mat_NB_5D_Yellow_Cup_POS2
			material_5d_head = Mat_NB_5D_Yellow_Cap_POS2
			material_5d_head_lit = Mat_NB_5D_Yellow_Cap_LIT_POS2
			material_5d_neck = Mat_NB_Neck
			material_5d_down = Mat_NB_5D_Yellow_Cup_DWN_POS2
			material_4d_lip = Mat_NB_4D_Yellow_rim_POS2
			material_4d_mid = Mat_NB_4D_Yellow_Cup_POS2
			material_4d_head = Mat_NB_4D_Yellow_Cap_POS2
			material_4d_head_lit = Mat_NB_4D_Yellow_Cap_LIT_POS2
			material_4d_neck = Mat_NB_Neck
			material_4d_down = Mat_NB_4D_Yellow_Cup_DWN_POS2
			material_open_lit = Mat_NB_Purple_Cap_LIT_POS3
			material_5d_open_lit = Mat_NB_Purple_Cap_LIT_POS2
			material_4d_open_lit = Mat_NB_Purple_Cap_LIT_POS2
		}
		blue = {
			name = button_b
			name_string = 'button_b'
			scale = -1.0
			scale_5d = 1.0
			scale_4d = -1.0
			material_lip = Mat_NB_Blue_rim_POS2
			material_mid = Mat_NB_Blue_Cup_POS2
			material_head = Mat_NB_Blue_Cap_POS2
			material_head_lit = Mat_NB_Blue_Cap_LIT_POS2
			material_neck = Mat_NB_Neck
			material_down = Mat_NB_Blue_Cup_DWN_POS2
			material_5d_lip = Mat_NB_5D_Blue_rim_POS3
			material_5d_mid = Mat_NB_5D_Blue_Cup_POS3
			material_5d_head = Mat_NB_5D_Blue_Cap_POS3
			material_5d_head_lit = Mat_NB_5D_Blue_Cap_LIT_POS3
			material_5d_neck = Mat_NB_Neck
			material_5d_down = Mat_NB_5D_Blue_Cup_DWN_POS3
			material_4d_lip = Mat_NB_4D_Blue_rim_POS2
			material_4d_mid = Mat_NB_4D_Blue_Cup_POS2
			material_4d_head = Mat_NB_4D_Blue_Cap_POS2
			material_4d_head_lit = Mat_NB_4D_Blue_Cap_LIT_POS2
			material_4d_neck = Mat_NB_Neck
			material_4d_down = Mat_NB_4D_Blue_Cup_DWN_POS2
			material_open_lit = Mat_NB_Purple_Cap_LIT_POS2
			material_5d_open_lit = Mat_NB_Purple_Cap_LIT_POS3
			material_4d_open_lit = Mat_NB_Purple_Cap_LIT_POS2
		}
		orange = {
			name = button_o
			name_string = 'button_o'
			scale = -1.0
			scale_5d = -1.0
			scale_4d = -1.0
			material_lip = Mat_NB_Orange_rim_POS1
			material_mid = Mat_NB_Orange_Cup_POS1
			material_head = Mat_NB_Orange_Cap_POS1
			material_head_lit = Mat_NB_Orange_Cap_LIT_POS1
			material_neck = Mat_NB_Neck
			material_down = Mat_NB_Orange_Cup_DWN_POS1
			material_5d_lip = Mat_NB_5D_Orange_rim_POS2
			material_5d_mid = Mat_NB_5D_Orange_Cup_POS2
			material_5d_head = Mat_NB_5D_Orange_Cap_POS2
			material_5d_head_lit = Mat_NB_5D_Orange_Cap_LIT_POS2
			material_5d_neck = Mat_NB_Neck
			material_5d_down = Mat_NB_5D_Orange_Cup_DWN_POS2
			material_4d_lip = Mat_NB_4D_Green_rim_POS1
			material_4d_mid = Mat_NB_4D_Green_Cup_POS1
			material_4d_head = Mat_NB_4D_Green_Cap_POS1
			material_4d_head_lit = Mat_NB_4D_Green_Cap_LIT_POS1
			material_4d_neck = Mat_NB_Neck
			material_4d_down = Mat_NB_4D_Green_Cup_DWN_POS1
			material_open_lit = Mat_NB_Purple_Cap_LIT_POS1
			material_5d_open_lit = Mat_NB_Purple_Cap_LIT_POS2
			material_4d_open_lit = Mat_NB_Purple_Cap_LIT_POS1
		}
		white = {
			name = button_w
			name_string = 'button_w'
			scale = 1.0
			scale_5d = 1.0
			scale_4d = 1.0
			material_lip = Mat_Placeholder
			material_mid = Mat_Placeholder
			material_head = Mat_Placeholder
			material_head_lit = Mat_Placeholder
			material_neck = Mat_Placeholder
			material_down = Mat_Placeholder
			material_5d_lip = Mat_Placeholder
			material_5d_mid = Mat_Placeholder
			material_5d_head = Mat_Placeholder
			material_5d_head_lit = Mat_Placeholder
			material_5d_neck = Mat_Placeholder
			material_5d_down = Mat_Placeholder
			material_4d_lip = Mat_Placeholder
			material_4d_mid = Mat_Placeholder
			material_4d_head = Mat_Placeholder
			material_4d_head_lit = Mat_Placeholder
			material_4d_neck = Mat_Placeholder
			material_4d_down = Mat_Placeholder
			material_open_lit = Mat_Placeholder
			material_5d_open_lit = Mat_Placeholder
			material_4d_open_lit = Mat_Placeholder
		}
		extra = {
			name = button_x
			name_string = 'button_x'
			scale = 1.0
			scale_5d = 1.0
			scale_4d = 1.0
			material_lip = sys_NowBar_Button01_Blue_Lip_sys_NowBar_Button01_Blue_Lip
			material_mid = sys_NowBar_Button01_Blue_Mid2_sys_NowBar_Button01_Blue_Mid2
			material_head = sys_NowBar_Head_Blue_sys_NowBar_Head_Blue
			material_head_lit = sys_NowBar_Head_BlueL_sys_NowBar_Head_BlueL
			material_neck = sys_NowBar_Neck01_sys_NowBar_Neck01
			material_down = sys_NowBar_Button01_Blue_Down_sys_NowBar_Button01_Blue_Down
			material_5d_lip = sys_NowBar_Button01_Blue_Lip_sys_NowBar_Button01_Blue_Lip
			material_5d_mid = sys_NowBar_Button01_Blue_Mid2_sys_NowBar_Button01_Blue_Mid2
			material_5d_head = sys_NowBar_Head_Blue_sys_NowBar_Head_Blue
			material_5d_head_lit = sys_NowBar_Head_BlueL_sys_NowBar_Head_BlueL
			material_5d_neck = sys_NowBar_Neck01_sys_NowBar_Neck01
			material_5d_down = sys_NowBar_Button01_Blue_Down_sys_NowBar_Button01_Blue_Down
			material_4d_lip = sys_NowBar_Button01_Blue_Lip_sys_NowBar_Button01_Blue_Lip
			material_4d_mid = sys_NowBar_Button01_Blue_Mid2_sys_NowBar_Button01_Blue_Mid2
			material_4d_head = sys_NowBar_Head_Blue_sys_NowBar_Head_Blue
			material_4d_head_lit = sys_NowBar_Head_BlueL_sys_NowBar_Head_BlueL
			material_4d_neck = sys_NowBar_Neck01_sys_NowBar_Neck01
			material_4d_down = sys_NowBar_Button01_Blue_Down_sys_NowBar_Button01_Blue_Down
			material_open_lit = sys_NowBar_Head_BlueL_sys_NowBar_Head_BlueL
			material_5d_open_lit = sys_NowBar_Head_BlueL_sys_NowBar_Head_BlueL
			material_4d_open_lit = sys_NowBar_Head_BlueL_sys_NowBar_Head_BlueL
		}
	}
	{
		green = {
			name = button_g
			name_string = 'button_g'
			scale = 1.0
			scale_5d = -1.0
			scale_4d = -1.0
			material_lip = Mat_NB_Green_rim_POS1
			material_mid = Mat_NB_Green_Cup_POS1
			material_head = Mat_NB_Green_Cap_POS1
			material_head_lit = Mat_NB_Green_Cap_LIT_POS1
			material_neck = Mat_NB_Neck
			material_down = Mat_NB_Green_Cup_DWN_POS1
			material_5d_lip = Mat_NB_5D_Green_rim_POS1
			material_5d_mid = Mat_NB_5D_Green_Cup_POS1
			material_5d_head = Mat_NB_5D_Green_Cap_POS1
			material_5d_head_lit = Mat_NB_5D_Green_Cap_LIT_POS1
			material_5d_neck = Mat_NB_Neck
			material_5d_down = Mat_NB_5D_Green_Cup_DWN_POS1
			material_4d_lip = Mat_NB_4D_Green_rim_POS1
			material_4d_mid = Mat_NB_4D_Green_Cup_POS1
			material_4d_head = Mat_NB_4D_Green_Cap_POS1
			material_4d_head_lit = Mat_NB_4D_Green_Cap_LIT_POS1
			material_4d_neck = Mat_NB_Neck
			material_4d_down = Mat_NB_4D_Green_Cup_DWN_POS1
			material_open_lit = Mat_NB_Purple_Cap_LIT_POS1
			material_5d_open_lit = Mat_NB_Purple_Cap_LIT_POS1
			material_4d_open_lit = Mat_NB_Purple_Cap_LIT_POS1
		}
		red = {
			name = button_r
			name_string = 'button_r'
			scale = 1.0
			scale_5d = 1.0
			scale_4d = 1.0
			material_lip = Mat_NB_Red_rim_POS2
			material_mid = Mat_NB_RED_Cup_POS2
			material_head = Mat_NB_Red_Cap_POS2
			material_head_lit = Mat_NB_Red_Cap_LIT_POS2
			material_neck = Mat_NB_Neck
			material_down = Mat_NB_RED_Cup_DWN_POS2
			material_5d_lip = Mat_NB_5D_Red_rim_POS1
			material_5d_mid = Mat_NB_5D_Red_Cup_POS1
			material_5d_head = Mat_NB_5D_Red_Cap_POS1
			material_5d_head_lit = Mat_NB_5D_Red_Cap_LIT_POS1
			material_5d_neck = Mat_NB_Neck
			material_5d_down = Mat_NB_5D_Red_Cup_DWN_POS1
			material_4d_lip = Mat_NB_4D_Red_rim_POS1
			material_4d_mid = Mat_NB_4D_Red_Cup_POS1
			material_4d_head = Mat_NB_4D_Red_Cap_POS1
			material_4d_head_lit = Mat_NB_4D_Red_Cap_LIT_POS1
			material_4d_neck = Mat_NB_Neck
			material_4d_down = Mat_NB_4D_Red_Cup_DWN_POS1
			material_open_lit = Mat_NB_Purple_Cap_LIT_POS2
			material_5d_open_lit = Mat_NB_Purple_Cap_LIT_POS1
			material_4d_open_lit = Mat_NB_Purple_Cap_LIT_POS1
		}
		yellow = {
			name = button_y
			name_string = 'button_y'
			scale = 1.0
			scale_5d = 1.0
			scale_4d = 1.0
			material_lip = Mat_NB_Yellow_rim_POS3
			material_mid = Mat_NB_Yellow_Cup_POS3
			material_head = Mat_NB_Yellow_Cap_POS3
			material_head_lit = Mat_NB_Yellow_Cap_LIT_POS3
			material_neck = Mat_NB_Neck
			material_down = Mat_NB_Yellow_Cup_DWN_POS3
			material_5d_lip = Mat_NB_5D_Yellow_rim_POS2
			material_5d_mid = Mat_NB_5D_Yellow_Cup_POS2
			material_5d_head = Mat_NB_5D_Yellow_Cap_POS2
			material_5d_head_lit = Mat_NB_5D_Yellow_Cap_LIT_POS2
			material_5d_neck = Mat_NB_Neck
			material_5d_down = Mat_NB_5D_Yellow_Cup_DWN_POS2
			material_4d_lip = Mat_NB_4D_Yellow_rim_POS2
			material_4d_mid = Mat_NB_4D_Yellow_Cup_POS2
			material_4d_head = Mat_NB_4D_Yellow_Cap_POS2
			material_4d_head_lit = Mat_NB_4D_Yellow_Cap_LIT_POS2
			material_4d_neck = Mat_NB_Neck
			material_4d_down = Mat_NB_4D_Yellow_Cup_DWN_POS2
			material_open_lit = Mat_NB_Purple_Cap_LIT_POS3
			material_5d_open_lit = Mat_NB_Purple_Cap_LIT_POS2
			material_4d_open_lit = Mat_NB_Purple_Cap_LIT_POS2
		}
		blue = {
			name = button_b
			name_string = 'button_b'
			scale = -1.0
			scale_5d = 1.0
			scale_4d = -1.0
			material_lip = Mat_NB_Blue_rim_POS2
			material_mid = Mat_NB_Blue_Cup_POS2
			material_head = Mat_NB_Blue_Cap_POS2
			material_head_lit = Mat_NB_Blue_Cap_LIT_POS2
			material_neck = Mat_NB_Neck
			material_down = Mat_NB_Blue_Cup_DWN_POS2
			material_5d_lip = Mat_NB_5D_Blue_rim_POS3
			material_5d_mid = Mat_NB_5D_Blue_Cup_POS3
			material_5d_head = Mat_NB_5D_Blue_Cap_POS3
			material_5d_head_lit = Mat_NB_5D_Blue_Cap_LIT_POS3
			material_5d_neck = Mat_NB_Neck
			material_5d_down = Mat_NB_5D_Blue_Cup_DWN_POS3
			material_4d_lip = Mat_NB_4D_Blue_rim_POS2
			material_4d_mid = Mat_NB_4D_Blue_Cup_POS2
			material_4d_head = Mat_NB_4D_Blue_Cap_POS2
			material_4d_head_lit = Mat_NB_4D_Blue_Cap_LIT_POS2
			material_4d_neck = Mat_NB_Neck
			material_4d_down = Mat_NB_4D_Blue_Cup_DWN_POS2
			material_open_lit = Mat_NB_Purple_Cap_LIT_POS2
			material_5d_open_lit = Mat_NB_Purple_Cap_LIT_POS3
			material_4d_open_lit = Mat_NB_Purple_Cap_LIT_POS2
		}
		orange = {
			name = button_o
			name_string = 'button_o'
			scale = -1.0
			scale_5d = -1.0
			scale_4d = -1.0
			material_lip = Mat_NB_Orange_rim_POS1
			material_mid = Mat_NB_Orange_Cup_POS1
			material_head = Mat_NB_Orange_Cap_POS1
			material_head_lit = Mat_NB_Orange_Cap_LIT_POS1
			material_neck = Mat_NB_Neck
			material_down = Mat_NB_Orange_Cup_DWN_POS1
			material_5d_lip = Mat_NB_5D_Orange_rim_POS2
			material_5d_mid = Mat_NB_5D_Orange_Cup_POS2
			material_5d_head = Mat_NB_5D_Orange_Cap_POS2
			material_5d_head_lit = Mat_NB_5D_Orange_Cap_LIT_POS2
			material_5d_neck = Mat_NB_Neck
			material_5d_down = Mat_NB_5D_Orange_Cup_DWN_POS2
			material_4d_lip = Mat_NB_4D_Green_rim_POS1
			material_4d_mid = Mat_NB_4D_Green_Cup_POS1
			material_4d_head = Mat_NB_4D_Green_Cap_POS1
			material_4d_head_lit = Mat_NB_4D_Green_Cap_LIT_POS1
			material_4d_neck = Mat_NB_Neck
			material_4d_down = Mat_NB_4D_Green_Cup_DWN_POS1
			material_open_lit = Mat_NB_Purple_Cap_LIT_POS1
			material_5d_open_lit = Mat_NB_Purple_Cap_LIT_POS2
			material_4d_open_lit = Mat_NB_Purple_Cap_LIT_POS1
		}
		white = {
			name = button_w
			name_string = 'button_w'
			scale = 1.0
			scale_5d = 1.0
			scale_4d = 1.0
			material_lip = Mat_Placeholder
			material_mid = Mat_Placeholder
			material_head = Mat_Placeholder
			material_head_lit = Mat_Placeholder
			material_neck = Mat_Placeholder
			material_down = Mat_Placeholder
			material_5d_lip = Mat_Placeholder
			material_5d_mid = Mat_Placeholder
			material_5d_head = Mat_Placeholder
			material_5d_head_lit = Mat_Placeholder
			material_5d_neck = Mat_Placeholder
			material_5d_down = Mat_Placeholder
			material_4d_lip = Mat_Placeholder
			material_4d_mid = Mat_Placeholder
			material_4d_head = Mat_Placeholder
			material_4d_head_lit = Mat_Placeholder
			material_4d_neck = Mat_Placeholder
			material_4d_down = Mat_Placeholder
			material_open_lit = Mat_Placeholder
			material_5d_open_lit = Mat_Placeholder
			material_4d_open_lit = Mat_Placeholder
		}
		extra = {
			name = button_x
			name_string = 'button_x'
			scale = 1.0
			scale_5d = 1.0
			scale_4d = 1.0
			material_lip = sys_NowBar_Button01_Blue_Lip_sys_NowBar_Button01_Blue_Lip
			material_mid = sys_NowBar_Button01_Blue_Mid2_sys_NowBar_Button01_Blue_Mid2
			material_head = sys_NowBar_Head_Blue_sys_NowBar_Head_Blue
			material_head_lit = sys_NowBar_Head_BlueL_sys_NowBar_Head_BlueL
			material_neck = sys_NowBar_Neck01_sys_NowBar_Neck01
			material_down = sys_NowBar_Button01_Blue_Down_sys_NowBar_Button01_Blue_Down
			material_5d_lip = sys_NowBar_Button01_Blue_Lip_sys_NowBar_Button01_Blue_Lip
			material_5d_mid = sys_NowBar_Button01_Blue_Mid2_sys_NowBar_Button01_Blue_Mid2
			material_5d_head = sys_NowBar_Head_Blue_sys_NowBar_Head_Blue
			material_5d_head_lit = sys_NowBar_Head_BlueL_sys_NowBar_Head_BlueL
			material_5d_neck = sys_NowBar_Neck01_sys_NowBar_Neck01
			material_5d_down = sys_NowBar_Button01_Blue_Down_sys_NowBar_Button01_Blue_Down
			material_4d_lip = sys_NowBar_Button01_Blue_Lip_sys_NowBar_Button01_Blue_Lip
			material_4d_mid = sys_NowBar_Button01_Blue_Mid2_sys_NowBar_Button01_Blue_Mid2
			material_4d_head = sys_NowBar_Head_Blue_sys_NowBar_Head_Blue
			material_4d_head_lit = sys_NowBar_Head_BlueL_sys_NowBar_Head_BlueL
			material_4d_neck = sys_NowBar_Neck01_sys_NowBar_Neck01
			material_4d_down = sys_NowBar_Button01_Blue_Down_sys_NowBar_Button01_Blue_Down
			material_open_lit = sys_NowBar_Head_BlueL_sys_NowBar_Head_BlueL
			material_5d_open_lit = sys_NowBar_Head_BlueL_sys_NowBar_Head_BlueL
			material_4d_open_lit = sys_NowBar_Head_BlueL_sys_NowBar_Head_BlueL
		}
	}
]
current_layout_combo = 1
layout_combos = [
	{
		players = 0
	}
	{
		players = 1
		parts = [
			guitar
		]
	}
	{
		players = 1
		parts = [
			Drum
		]
	}
	{
		players = 1
		parts = [
			vocals
		]
	}
	{
		players = 2
		parts = [
			guitar
			guitar
		]
	}
	{
		players = 2
		parts = [
			guitar
			Drum
		]
	}
	{
		players = 2
		parts = [
			Drum
			guitar
		]
	}
	{
		players = 2
		parts = [
			guitar
			vocals
		]
	}
	{
		players = 2
		parts = [
			Drum
			vocals
		]
	}
	{
		players = 3
		parts = [
			guitar
			Drum
			guitar
		]
	}
	{
		players = 3
		parts = [
			Drum
			guitar
			guitar
		]
	}
	{
		players = 3
		parts = [
			guitar
			guitar
			Drum
		]
	}
	{
		players = 3
		parts = [
			guitar
			Drum
			vocals
		]
	}
	{
		players = 3
		parts = [
			guitar
			guitar
			vocals
		]
	}
	{
		players = 4
		parts = [
			guitar
			guitar
			Drum
			vocals
		]
	}
]

script toggle_debug_highways \{combo = -1}
	GetArraySize \{$layout_combos}
	if NOT (<combo> = -1)
		Change current_layout_combo = <combo>
		if ($current_layout_combo > (<array_size> -1))
			Change \{current_layout_combo = 0}
		endif
		if ($current_layout_combo < 0)
			Change \{current_layout_combo = 0}
		endif
	endif
	<players> = ($layout_combos [$current_layout_combo].players)
	<parts> = ($layout_combos [$current_layout_combo].parts)
	create_debug_highways <...>
	if (<combo> = -1)
		Change current_layout_combo = ($current_layout_combo + 1)
		if ($current_layout_combo > (<array_size> -1))
			Change \{current_layout_combo = 0}
		endif
	endif
endscript

script create_debug_highways \{players = 4
		parts = [
			guitar
			guitar
			guitar
			guitar
		]}
	DestroyScreenElement \{id = debug_gem_container1}
	DestroyScreenElement \{id = debug_gem_container2}
	DestroyScreenElement \{id = debug_gem_container3}
	DestroyScreenElement \{id = debug_gem_container4}
	if (<players> > 0)
		if (<players> <= 4)
			old_parts = [guitar guitar guitar guitar]
			<player> = 1
			begin
			GetPlayerInfo <player> part
			SetArrayElement arrayName = old_parts index = (<player> -1) newValue = <part>
			<new_part> = (<parts> [(<player> -1)])
			SetPlayerInfo <player> part = <new_part>
			<player> = (<player> + 1)
			repeat <players>
			update_hud_layout
			debug_refresh_hud
			<player> = 1
			begin
			<part> = (<parts> [(<player> -1)])
			if checksumequals a = <part> b = vocals
				setup_debug_vocals_highway player = <player>
			else
				get_num_non_vocals_players_onscreen
				setup_debug_highway player = <player> total_players = <num_non_vocals_players>
			endif
			<player> = (<player> + 1)
			repeat <players>
			<player> = 1
			begin
			SetPlayerInfo <player> part = (<old_parts> [(<player> -1)])
			<player> = (<player> + 1)
			repeat <players>
		endif
	endif
endscript

script setup_debug_highway \{player = 1
		total_players = 3}
	SetScreenElementLock \{id = root_window
		off}
	generate_pos_table player = <player> debug
	get_highway_struct player = <player>
	pos_table = <struct>
	get_highway_pos_and_scale num_non_vocals_players = <total_players> non_vocalist_player = <player> player = <player>
	FormatText checksumname = container_id 'debug_gem_container%p' p = <player> AddToStringLookup = true
	DestroyScreenElement id = <container_id>
	CreateScreenElement {
		type = ContainerElement
		id = <container_id>
		parent = root_window
		Pos = <Pos>
		just = [left top]
		scale = <scale>
		z_priority = 0
	}
	hpos = ((640.0 - ((<pos_table>.highway_top_width) / 2.0)) * (1.0, 0.0))
	hdims = ((<pos_table>.highway_top_width) * (1.0, 0.0))
	<highway_material> = $debug_highway_material
	FormatText checksumname = highway_name 'Debug_Highway_2D%p' p = <player> AddToStringLookup = true
	CreateScreenElement {
		type = SpriteElement
		id = <highway_name>
		parent = <container_id>
		clonematerial = <highway_material>
		rgba = $highway_normal
		Pos = <hpos>
		dims = <hdims>
		just = [left left]
		z_priority = 0.1
	}
	GetProjectSpecificSpriteParams
	SetScreenElementProps id = <highway_name> MaterialProps = [
		{name = m_startFade property = <HighwayStartFade>}
		{name = m_endFade property = <HighwayEndFade>}
		{name = m_playerIndex property = (<player> + 4)}
	]
	SetScreenElementLock \{id = root_window
		on}
endscript

script setup_debug_vocals_highway \{player = 1}
	FormatText checksumname = container_id 'debug_gem_container%p' p = <player> AddToStringLookup = true
	DestroyScreenElement id = <container_id>
	CreateScreenElement {
		type = ContainerElement
		id = <container_id>
		parent = root_window
		Pos = (0.0, 0.0)
		just = [left top]
		z_priority = 0
	}
	vocals_create_highway parent = <container_id> player = <player> vocals_highway_view = static
	vocals_highway_slide_in player = <player>
endscript

script get_highway_pos_and_scale 
	if ($calibrate_lag_enabled = 1)
		SetPlayerInfo <player> highway_position = center
		return \{Pos = (-250.0, 0.0)
			scale = (1.0, 1.0)
			hw_x_scale = 1
			hw_y_scale = 1
			extra_offset_factor = 0}
	endif
	GameMode_GetType
	if (<type> = freeplay)
		GetPlayerInfo <player> highway_position
		if (<highway_position> = null || <highway_position> = vocal1)
			SetPlayerInfo <player> highway_position = center
		endif
		freeplay_update_actual_position player = <player> ignore_scale = 1
		return Pos = <Pos> scale = (1.0, 1.0) hw_x_scale = 1 hw_y_scale = 1
	endif
	if musicstudio_mainobj :MusicStudio_IsInMusicStudio
		musicstudio_jamroom_collapse_player_num player = <non_vocalist_player>
	endif
	<Pos> = (0.0, 0.0)
	<scale> = (1.0, 1.0)
	switch <num_non_vocals_players>
		case 1
		high_pos = center
		case 2
		switch <non_vocalist_player>
			case 1
			high_pos = left
			case 2
			high_pos = right
		endswitch
		case 3
		switch <non_vocalist_player>
			case 1
			high_pos = left
			case 2
			high_pos = center
			case 3
			high_pos = right
		endswitch
		case 4
		if (<player> = 1)
			high_pos = left
		elseif (<player> = 2)
			high_pos = leftcenter
		elseif (<player> = 3)
			high_pos = rightcenter
		else
			high_pos = right
		endif
		default
		ScriptAssert 'did not expect %n non-vocals highways' n = <num_non_vocals_players>
	endswitch
	SetPlayerInfo <player> highway_position = <high_pos>
	highway_scale_chart = ($highway_scale_chart)
	hw_x_scale = (<highway_scale_chart> [<num_non_vocals_players> - 1].hw_x_scale)
	hw_y_scale = (<highway_scale_chart> [<num_non_vocals_players> - 1].hw_y_scale)
	x_pos = (<highway_scale_chart> [<num_non_vocals_players> - 1].<high_pos>.x_pos)
	extra_offset_factor = (<highway_scale_chart> [<num_non_vocals_players> - 1].extra_offset_factor)
	Pos = ((1.0, 0.0) * <x_pos>)
	get_highway_hud_root_id player = <player>
	SetPlayerInfo <player> hud_parent = <highway_hud_root>
	return Pos = <Pos> scale = <scale> hw_x_scale = <hw_x_scale> hw_y_scale = <hw_y_scale> extra_offset_factor = <extra_offset_factor>
endscript

script get_scale_on_guitar_string 
	<pos_start> = (($button_models [(<player> -1)]).<Color>.start_pos)
	<pos_end> = (($button_models [(<player> -1)]).<Color>.end_pos)
	<total_length> = (<pos_end>.(0.0, 1.0) - <pos_start>.(0.0, 1.0))
	<lerp> = (<offset> / <total_length>)
	pos_table = ($highway_pos_table [(<player> -1)])
	<scale_start> = (<pos_table>.gem_start_scale [0])
	<widthOffsetFactor> = ((<pos_table>.widthOffsetFactor) * <lerp>)
	<new_scale> = (<scale_start> + (<scale_start> * <widthOffsetFactor>))
	return new_scale = <new_scale>
endscript

script get_point_on_guitar_string 
	<angle> = (($button_models [(<player> -1)]).<Color>.angle)
	Cos <angle>
	<offset> = (<offset> / <Cos>)
	<pos_start> = (($button_models [(<player> -1)]).<Color>.start_pos)
	<pos_end> = (($button_models [(<player> -1)]).<Color>.end_pos)
	norm2d = (<pos_end> - <pos_start>)
	<norm> = ((<norm2d>.(1.0, 0.0) * (1.0, 0.0, 0.0)) + (<norm2d>.(0.0, 1.0) * (0.0, 1.0, 0.0)))
	NormalizeVector <norm>
	<offset2d> = (<norm> * <offset>)
	<offset2d> = ((<offset2d>.(1.0, 0.0, 0.0) * (1.0, 0.0)) + (<offset2d>.(0.0, 1.0, 0.0) * (0.0, 1.0)))
	if (<offset_type> = bottom)
		<new_point> = (<pos_end> + <offset2d>)
	else
		<new_point> = (<pos_start> + <offset2d>)
	endif
	return new_point = <new_point>
endscript

script setup_highway \{player = 1
		jam_room_highway = 0
		skip_highway_move = false}
	generate_pos_table player = <player> jam_room_highway = <jam_room_highway>
	SetScreenElementLock \{id = root_window
		off}
	get_num_non_vocals_players_onscreen
	get_non_vocalist_player_number player = <player>
	get_highway_pos_and_scale num_non_vocals_players = <num_non_vocals_players> non_vocalist_player = <non_vocalist_player> player = <player>
	if (<skip_highway_move> = true)
		if (<jam_room_highway> = 1)
			<container_pos> = (<Pos> + (0.0, 0.0))
		else
			<container_pos> = (<Pos> + (0.0, 410.0))
		endif
	else
		<container_pos> = (<Pos> + (0.0, 720.0))
	endif
	pos_table = ($highway_pos_table [(<player> -1)])
	FormatText checksumname = hw_container_id 'highway_containerp%p' p = <player> AddToStringLookup = true
	CreateScreenElement {
		type = ContainerElement
		id = <hw_container_id>
		parent = highway_root_window
		just = [center center]
		scale = <scale>
		z_priority = 0
		Pos = <container_pos>
		alpha = 0
		tags = {
			curr_x_scale = 1.0
			dest_x_scale = 1.0
			curr_y_scale = 1.0
			dest_y_scale = 1.0
			curr_x_pos = (<container_pos> [0])
			dest_x_pos = (<container_pos> [0])
			curr_y_pos = (<container_pos> [1])
			dest_y_pos = (<container_pos> [1])
			curr_extra_offset_factor = 0
			dest_extra_offset_factor = 0
			curr_heightOffsetFactor = (<pos_table>.perspectivefact)
			curr_heightOffsetExp = (<pos_table>.perspectiveexp)
			dest_heightOffsetFactor = (<pos_table>.perspectivefact)
			dest_heightOffsetExp = (<pos_table>.perspectiveexp)
		}
	}
	FormatText checksumname = container_id 'gem_containerp%p' p = <player> AddToStringLookup = true
	CreateScreenElement {
		type = ContainerElement
		id = <container_id>
		parent = <hw_container_id>
		just = [center center]
		scale = <scale>
		z_priority = 0
		Pos = (0.0, 0.0)
	}
	FormatText checksumname = gem_notes_id 'gem_notes_containerp%p' p = <player> AddToStringLookup = true
	CreateScreenElement {
		type = ContainerElement
		parent = <container_id>
		id = <gem_notes_id>
		just = [center center]
	}
	FormatText checksumname = fretbar_id 'fretbar_containerp%p' p = <player> AddToStringLookup = true
	CreateScreenElement {
		type = ContainerElement
		parent = <container_id>
		id = <fretbar_id>
		just = [center center]
	}
	hpos = ((0.0 - ((<pos_table>.highway_top_width) / 2.0)) * (1.0, 0.0))
	hdims = ((<pos_table>.highway_top_width) * (1.0, 0.0))
	GetPlayerInfo <player> highway_texture
	create_highway_material player = <player> texture = `tex\models\Highway\Highway_Judy_fm_01.dds`
	FormatText checksumname = highway_name 'Highway_2Dp%p' p = <player> AddToStringLookup = true
	CreateScreenElement {
		type = SpriteElement
		id = <highway_name>
		parent = <container_id>
		clonematerial = <highway_material>
		rgba = $highway_normal
		Pos = <hpos>
		dims = <hdims>
		just = [left top]
		z_priority = 0.1
	}
	GetPlayerInfo <player> scroll_time
	highway_speed = (0.0 - ((<pos_table>.gHighwayTiling) / (<scroll_time> - $destroy_time)))
	printf qs(0x2e358b62) H = <highway_speed>
	Set2DHighwaySpeed speed = <highway_speed> id = <highway_name> player = <player>
	GetPlayerInfo <player> band_member
	if (<band_member> = Drummer)
		SetMaterialProperty mat = 'Mat_Drum_Fill' prop = 'm_velocityV' x = <highway_speed> y = 0.0 z = 0.0 w = 0.0
	elseif (<band_member> = drummer2)
		SetMaterialProperty mat = 'Mat_Drum_Fill2' prop = 'm_velocityV' x = <highway_speed> y = 0.0 z = 0.0 w = 0.0
	endif
	if (<jam_room_highway> = 1)
		<hw_y_scale> = 1
	endif
	fe = ((<pos_table>.highway_playline) - ((<pos_table>.highway_height) * <hw_y_scale>))
	fs = (<fe> + ((<pos_table>.highway_fade) * <hw_y_scale>))
	Set2DHighwayFade start = <fs> end = <fe> id = <highway_name> player = <player>
	if (<jam_room_highway> = 0)
		SetProjectSpecificSpriteParams HighwayStartFade = <fs> HighwayEndFade = <fe> player = <player>
	endif
	SetHighwayFadeParams topFade = <fe> bottomFade = <fs> player = <player>
	Pos = ((0.0, 0.0) + ((<pos_table>.highway_playline) * (0.0, 1.0)))
	lpos = (($sidebar_x [(<player> -1)] * (1.0, 0.0)) + ($sidebar_y [(<player> -1)] * (0.0, 1.0)))
	langle = ($sidebar_angle [(<player> -1)])
	rpos = ((((0.0 - $sidebar_x [(<player> -1)]) + 0.0) * (1.0, 0.0)) + ($sidebar_y [(<player> -1)] * (0.0, 1.0)))
	rangle = (0.0 - ($sidebar_angle [(<player> -1)]))
	scale = (((<pos_table>.sidebar_x_scale) * (2.0, 0.0)) + ((<pos_table>.sidebar_y_scale) * (0.0, 1.0)))
	rscale = (((0 - (<pos_table>.sidebar_x_scale)) * (2.0, 0.0)) + ((<pos_table>.sidebar_y_scale) * (0.0, 1.0)))
	NSGscale = (((<pos_table>.sidebar_x_scale) * (2.0, 0.0)) + ((<pos_table>.sidebar_y_scale) * (0.0, 4.0)))
	NGSrscale = (((0 - (<pos_table>.sidebar_x_scale)) * (2.0, 0.0)) + ((<pos_table>.sidebar_y_scale) * (0.0, 4.0)))
	FormatText checksumname = sidebar_left_container 'sidebar_container_leftp%p' p = <player> AddToStringLookup = true
	CreateScreenElement {
		type = ContainerElement
		id = <sidebar_left_container>
		parent = <container_id>
		Pos = <lpos>
		rot_angle = <langle>
		just = [center bottom]
		z_priority = 3
	}
	FormatText checksumname = name 'Sidebar_NSGLOW_leftp%p' p = <player> AddToStringLookup = true
	CreateScreenElement {
		type = SpriteElement
		id = <name>
		parent = <sidebar_left_container>
		material = Mat_sidebar_GLOW_01
		rgba = [255 128 0 0]
		Pos = (1.0, 0.0)
		scale = <NSGscale>
		just = [right bottom]
		z_priority = 5.9
		hide
	}
	FormatText checksumname = name 'sidebar_leftp%p' p = <player> AddToStringLookup = true
	CreateScreenElement {
		type = SpriteElement
		id = <name>
		parent = <sidebar_left_container>
		material = sys_sidebar2D_sys_sidebar2D
		rgba = [255 255 255 255]
		Pos = (2.0, 0.0)
		scale = <scale>
		just = [right bottom]
		z_priority = 3
	}
	Set2DHighwayFade start = <fs> end = <fe> id = <name> player = <player>
	FormatText checksumname = sidebar_right_container 'sidebar_container_rightp%p' p = <player> AddToStringLookup = true
	CreateScreenElement {
		type = ContainerElement
		id = <sidebar_right_container>
		parent = <container_id>
		Pos = <rpos>
		rot_angle = <rangle>
		just = [center bottom]
		z_priority = 3
	}
	FormatText checksumname = name 'Sidebar_NSGLOW_rightp%p' p = <player> AddToStringLookup = true
	CreateScreenElement {
		type = SpriteElement
		id = <name>
		parent = <sidebar_right_container>
		material = Mat_sidebar_GLOW_01
		rgba = [255 128 0 0]
		rot_angle = 0
		Pos = (4.0, 0.0)
		scale = <NGSrscale>
		just = [left bottom]
		z_priority = 5.9
		hide
	}
	FormatText checksumname = name 'sidebar_rightp%p' p = <player> AddToStringLookup = true
	CreateScreenElement {
		type = SpriteElement
		id = <name>
		parent = <sidebar_right_container>
		material = sys_sidebar2D_sys_sidebar2D
		rgba = [255 255 255 255]
		Pos = (-1.0, 0.0)
		scale = <rscale>
		just = [left bottom]
		z_priority = 3
	}
	Set2DHighwayFade start = <fs> end = <fe> id = <name> player = <player>
	GetPlayerInfo <player> part
	FormatText checksumname = nowbar_id 'nowbar_container_p%p' p = <player> AddToStringLookup = true
	CreateScreenElement {
		type = ContainerElement
		id = <nowbar_id>
		parent = <hw_container_id>
		Pos = (0.0, 0.0)
		just = [center center]
		z_priority = 1
	}
	setup_button_up_models player = <player> part = <part> container_id = <nowbar_id> pos_table = <pos_table> jam_room_highway = <jam_room_highway>
	if (<skip_highway_move> = false)
		setup_highway_move <...>
	else
		if (<jam_room_highway> = 1)
			<hw_container_id> :SE_SetProps alpha = 1
		else
			<hw_container_id> :SE_SetProps alpha = 0
		endif
	endif
	create_highway_prepass <...>
	SetScreenElementLock \{id = root_window
		on}
	if (<jam_room_highway> = 0)
		setup_individual_highway_hud player = <player>
	endif
	<hw_container_id> :SetTags {
		start_x_pos = (<container_pos> [0])
		start_y_pos = (<container_pos> [1])
		start_extra_offset_factor = <extra_offset_factor>
		start_x_scale = <hw_x_scale>
		start_y_scale = <hw_y_scale>
		start_heightOffsetFactor = (<pos_table>.perspectivefact)
		start_heightOffsetExp = (<pos_table>.perspectiveexp)
		dest_extra_offset_factor = <extra_offset_factor>
		dest_x_scale = <hw_x_scale>
		dest_y_scale = <hw_y_scale>
		lerping_factor = 0
	}
	if (<jam_room_highway> = 0)
		<hw_container_id> :Obj_SpawnScript highway_scale_manager params = {player = <player> jamroom_highway = <jam_room_highway>}
	endif
endscript

script refresh_button_models \{jam_room_highway = 0}
	RequireParams \{[
			player
		]
		all}
	FormatText checksumname = nowbar_id 'nowbar_container_p%p' p = <player>
	GetPlayerInfo <player> part
	pos_table = ($highway_pos_table [(<player> -1)])
	DestroyScreenElement id = <nowbar_id> preserve_parent
	setup_button_up_models player = <player> part = <part> container_id = <nowbar_id> pos_table = <pos_table> jam_room_highway = <jam_room_highway>
endscript

script setup_button_up_models \{jam_room_highway = 0}
	now_scale = (((<pos_table>.nowbar_scale_x) * (1.0, 0.0)) + ((<pos_table>.nowbar_scale_y) * (0.0, 1.0)))
	GetArraySize \{$gem_colors}
	array_count = 0
	begin
	Color = ($gem_colors [<array_count>])
	if StructureContains structure = (($button_up_models [(<player> -1)]).<Color>) name = name
		if NOT (<part> = Drum)
			if PlayerInfoEquals <player> lefthanded_button_ups = 1
				<pos2d> = (($button_up_models [(<player> -1)]).<Color>.left_pos_2d)
				<playline_scale> = (((0 - <now_scale>.(1.0, 0.0)) * (1.0, 0.0)) + (<now_scale>.(0.0, 1.0) * (0.0, 1.0)))
			else
				<pos2d> = (($button_up_models [(<player> -1)]).<Color>.pos_2d)
				<playline_scale> = <now_scale>
			endif
		else
			<pos2d> = (($button_up_models [(<player> -1)]).<Color>.pos_2d)
			<playline_scale> = <now_scale>
		endif
		if (<jam_room_highway> = 1)
			get_point_on_guitar_string player = <player> Color = <Color> offset = $musicstudio_jamroom_gem_offset offset_type = top
			if NOT (<part> = Drum)
				if PlayerInfoEquals <player> lefty_flip = 1
					<new_point> = (((0 - <new_point>.(1.0, 0.0)) * (1.0, 0.0)) + (<new_point>.(0.0, 1.0) * (0.0, 1.0)))
					flip_v = flip_v
				endif
			endif
			<pos2d> = <new_point>
			get_scale_on_guitar_string player = <player> Color = <Color> offset = ($musicstudio_jamroom_gem_offset -40)
			<playline_scale> = ((1.0, 1.0) * <new_scale>)
			get_num_non_vocals_players_onscreen
			<value> = ($musicstudio_jamroom_nowbar_offsets [(<num_non_vocals_players> -1)].scale_adj)
			<playline_scale> = (<playline_scale> * <value>)
		endif
		get_num_non_vocals_players_onscreen
		if (<array_count> = 0)
			FormatText checksumname = nowbar_glow_name 'nowbar_glowp%p' p = <player> AddToStringLookup = true
			nowbar_glow_pos = $nowbar_glow_pos
			if (<num_non_vocals_players> = 1)
				nowbar_glow_scale = (<now_scale> * $nowbar_glow_scale1)
			elseif (<num_non_vocals_players> = 2)
				nowbar_glow_scale = (<now_scale> * $nowbar_glow_scale2)
			else
				nowbar_glow_scale = (<now_scale> * $nowbar_glow_scale3)
			endif
			nowbar_glow_material = Mat_NB_PerfGlow01
			CreateScreenElement {
				type = SpriteElement
				id = <nowbar_glow_name>
				parent = <container_id>
				material = <nowbar_glow_material>
				rgba = [255 255 255 0]
				Pos = <nowbar_glow_pos>
				rot_angle = 0
				scale = <nowbar_glow_scale>
				just = [center center]
				z_priority = 12.110001
			}
			GuitarEvent_Fretbar_CFunc
		endif
		Pos = (640.0, 643.0)
		<Pos> = (((<pos2d>.(1.0, 0.0)) * (1.0, 0.0)) + (1024 * (0.0, 1.0)))
		if (<part> = Drum)
			if UseFourLaneHighway player = <player>
				<flip_scale> = (($button_up_models [(<player> -1)]).<Color>.scale_4d)
			else
				<flip_scale> = (($button_up_models [(<player> -1)]).<Color>.scale_5d)
			endif
		else
			<flip_scale> = (($button_up_models [(<player> -1)]).<Color>.scale)
		endif
		<playline_scale> = (((<playline_scale>.(1.0, 0.0) * <flip_scale>) * (1.0, 0.0)) + (<playline_scale>.(0.0, 1.0) * (0.0, 1.0)))
		<color_string> = (($button_up_models [(<player> -1)]).<Color>.name_string)
		FormatText checksumname = name_base '%s_basep%p' s = <color_string> p = <player> AddToStringLookup = true
		FormatText checksumname = name_string '%s_stringp%p' s = <color_string> p = <player> AddToStringLookup = true
		FormatText checksumname = name_lip '%s_lipp%p' s = <color_string> p = <player> AddToStringLookup = true
		FormatText checksumname = name_mid '%s_midp%p' s = <color_string> p = <player> AddToStringLookup = true
		FormatText checksumname = name_neck '%s_neckp%p' s = <color_string> p = <player> AddToStringLookup = true
		FormatText checksumname = name_head '%s_headp%p' s = <color_string> p = <player> AddToStringLookup = true
		FormatText checksumname = name_touch_glow '%s_touch_glowp%p' s = <color_string> p = <player> AddToStringLookup = true
		CreateScreenElement {
			type = ContainerElement
			id = <name_base>
			parent = <container_id>
			Pos = (0.0, 0.0)
			just = [center bottom]
			<flip_v>
		}
		if (<Color> = white)
			pos_right = (($button_up_models [(<player> -1)]).extra.left_pos_2d)
			pos_left = (($button_up_models [(<player> -1)]).extra.pos_2d)
			pos_right = (<pos_right> + (-10.0, 20.0))
			pos_left = (<pos_left> + (10.0, 20.0))
			dist = (<pos_right>.(1.0, 0.0) - <pos_left>.(1.0, 0.0))
			mid_scale_x = (<dist> / 512.0)
			mid_scale = (<mid_scale_x> * (1.0, 0.0))
			highlight_scale = (<mid_scale> + (0.1, 0.5))
			mid_scale = (<mid_scale> + (0.0, 1.0))
			FormatText checksumname = cont 'Drum_Kick_container_p%p' p = <player> AddToStringLookup = true
			CreateScreenElement {
				type = ContainerElement
				id = <cont>
				parent = <container_id>
				Pos = (0.0, 0.0)
				rot_angle = 0
				just = [center bottom]
				z_priority = 3.1
			}
		else
			if (<part> = Drum)
				if UseFourLaneHighway player = <player>
					material_lip = (($button_up_models [(<player> -1)]).<Color>.material_4d_lip)
					material_mid = (($button_up_models [(<player> -1)]).<Color>.material_4d_mid)
					material_neck = (($button_up_models [(<player> -1)]).<Color>.material_4d_neck)
					material_head = (($button_up_models [(<player> -1)]).<Color>.material_4d_head)
				else
					material_lip = (($button_up_models [(<player> -1)]).<Color>.material_5d_lip)
					material_mid = (($button_up_models [(<player> -1)]).<Color>.material_5d_mid)
					material_neck = (($button_up_models [(<player> -1)]).<Color>.material_5d_neck)
					material_head = (($button_up_models [(<player> -1)]).<Color>.material_5d_head)
				endif
			else
				material_lip = (($button_up_models [(<player> -1)]).<Color>.material_lip)
				material_mid = (($button_up_models [(<player> -1)]).<Color>.material_mid)
				material_neck = (($button_up_models [(<player> -1)]).<Color>.material_neck)
				material_head = (($button_up_models [(<player> -1)]).<Color>.material_head)
			endif
			<button_up_alpha> = 1.0
			if (<jam_room_highway> = 1)
				GetPlayerInfo <player> controller
				if IsRBDrum controller = <controller>
					if (<Color> = orange)
						<button_up_alpha> = 0.1
					endif
				endif
			endif
			CreateScreenElement {
				type = SpriteElement
				id = <name_lip>
				parent = <name_base>
				material = <material_lip>
				rgba = [255 255 255 255]
				Pos = <pos2d>
				scale = <playline_scale>
				just = [center bottom]
				z_priority = 3.9
				alpha = <button_up_alpha>
			}
			if (<jam_room_highway> = 1)
				<pos_offset> = ($musicstudio_jamroom_nowbar_offsets [(<num_non_vocals_players> -1)].pos_offset)
				<pos_offset> = ((0.0, 1.0) * <pos_offset>)
				<tpos> = (<pos2d> + <pos_offset>)
				<neck_pos> = (<pos2d> + <pos_offset>)
				<trot> = 180
			else
				<tpos> = <pos2d>
				<trot> = 0
			endif
			CreateScreenElement {
				type = SpriteElement
				id = <name_mid>
				parent = <name_base>
				material = <material_mid>
				rgba = [255 255 255 255]
				Pos = <tpos>
				scale = <playline_scale>
				just = [center bottom]
				rot_angle = <trot>
				z_priority = 3.6
				alpha = <button_up_alpha>
			}
			<y_scale> = ($neck_lip_add / $neck_sprite_size)
			<Pos> = (<pos2d> - ($neck_lip_base * (0.0, 1.0)))
			if (<jam_room_highway> = 1)
				<neck_y_scale> = 0
				<neck_pos> = <Pos>
			else
				<neck_y_scale> = <y_scale>
				<neck_pos> = <Pos>
			endif
			<neck_scale> = (((<playline_scale>.(1.0, 0.0)) * (1.0, 0.0)) + (<neck_y_scale> * (0.0, 1.0)))
			CreateScreenElement {
				type = SpriteElement
				id = <name_neck>
				parent = <name_base>
				material = <material_neck>
				rgba = [255 255 255 255]
				Pos = <neck_pos>
				scale = <neck_scale>
				just = [center bottom]
				z_priority = 3.7
				alpha = <button_up_alpha>
			}
			CreateScreenElement {
				type = SpriteElement
				id = <name_head>
				parent = <name_base>
				material = <material_head>
				rgba = [255 255 255 255]
				Pos = <pos2d>
				scale = <playline_scale>
				just = [center bottom]
				z_priority = 3.8
				alpha = <button_up_alpha>
			}
			<string_scale> = (((<pos_table>.string_scale_x) * (1.0, 0.0)) + ((<pos_table>.string_scale_y) * (0.0, 1.0)))
			if (<jam_room_highway> = 1)
				<string_scale> = (<string_scale> + (0.0, 0.15))
			endif
			if NOT PlayerInfoEquals <player> part = Drum
				if (<array_count> < <array_size>)
					string_pos2d = (($button_up_models [(<player> -1)]).<Color>.pos_2d)
					if (<jam_room_highway> = 1)
						get_point_on_guitar_string player = <player> Color = <Color> offset = 75 offset_type = bottom
						<string_pos2d> = <new_point>
					endif
					CreateScreenElement {
						type = SpriteElement
						id = <name_string>
						parent = <container_id>
						material = sys_String01_sys_String01
						rgba = [200 200 200 200]
						scale = <string_scale>
						rot_angle = (($button_models [(<player> -1)]).<Color>.angle)
						Pos = <string_pos2d>
						just = [center bottom]
						z_priority = 3.5
					}
				endif
			else
				FormatText checksumname = name_challenge 'challenge_drum%i_p%p' i = <array_count> p = <player> AddToStringLookup = true
				FormatText TextName = challenge_text qs(0xfd68af01) i = <array_count>
				CreateScreenElement {
					type = TextElement
					text = <challenge_text>
					id = <name_challenge>
					parent = <name_lip>
					font = fontgrid_text_A3
					rgba = [255 255 255 255]
					Pos = (55.0, 0.0)
					scale = 2.0
					just = [center bottom]
					z_priority = 14.0
				}
				<name_challenge> :SE_SetProps hide
			endif
			if (<array_count> < <array_size>)
				touch_glow_gem_count = <array_count>
				touch_glow_color = <Color>
				if NOT PlayerInfoEquals <player> part = Drum
					props = $touch_glow_props
				else
					if UseFourLaneHighway player = <player>
						props = $touch_glow_props_rb_drum
					else
						props = $touch_glow_props_drum
					endif
				endif
				if StructureContains structure = (<props> [<touch_glow_gem_count>]) name = flip_v
					flip_v = flip_v
				else
					RemoveParameter \{flip_v}
				endif
				<tg_x_scale> = ((<string_scale> [0]) * 3.0)
				<tg_y_scale> = ((<string_scale> [1]) * 2.5)
				touch_glow_scale = ((<tg_x_scale> * (1.0, 0.0)) + (<tg_y_scale> * (0.0, 1.0)))
				CreateScreenElement {
					type = SpriteElement
					id = <name_touch_glow>
					parent = <container_id>
					material = (<props> [<touch_glow_gem_count>].mat)
					rgba = (<props> [<array_count>].rgba)
					scale = <touch_glow_scale>
					rot_angle = ((($button_models [(<player> -1)]).<touch_glow_color>.angle) + (<props> [<touch_glow_gem_count>].rot_offset))
					Pos = (($button_up_models [(<player> -1)]).<touch_glow_color>.pos_2d)
					just = [center bottom]
					alpha = 0.0
					z_priority = 4
					<flip_v>
				}
			endif
		endif
	endif
	array_count = (<array_count> + 1)
	repeat <array_size>
endscript

script setup_highway_move 
	spawnscriptnow move_highway_2d params = {<...>}
endscript

script destroy_highway 
	destroy_highway_prepass <...>
	FormatText checksumname = name 'Highway_2Dp%p' p = <player>
	DestroyScreenElement id = <name>
	FormatText checksumname = name 'gem_containerp%p' p = <player>
	DestroyScreenElement id = <name>
	FormatText checksumname = name 'Gem_basebarp%p' p = <player>
	DestroyScreenElement id = <name>
	FormatText checksumname = name 'highway_containerp%p' p = <player>
	DestroyScreenElement id = <name>
	GetArraySize \{$gem_colors}
	array_count = 0
	begin
	Color = ($gem_colors [<array_count>])
	if StructureContains structure = (($button_up_models [(<player> -1)]).<Color>) name = name_string
		FormatText checksumname = name '%sp%p' s = (($button_up_models [(<player> -1)]).<Color>.name_string) p = <player> AddToStringLookup = true
		DestroyScreenElement id = <name>
	endif
	array_count = (<array_count> + 1)
	repeat <array_size>
endscript
prepass_camera_pos = (500.0, -100.0, -100.0)
prepass_border = 8

script calculate_prepass_poly_params \{x_offset = 0}
	prepass_mdl_top_width = 1
	prepass_mdl_bottom_width = 3.5
	prepass_mdl_height = 1
	pos_table = ($highway_pos_table [(<player> -1)])
	w0 = (<pos_table>.highway_top_width)
	highway_slope = (<w0> * (<pos_table>.widthOffsetFactor) / (<pos_table>.highway_height))
	highway_start = ((<pos_table>.highway_playline) - (<pos_table>.highway_height))
	prepass_start = ((<pos_table>.highway_fade) + $prepass_border)
	prepass_top_width = (<w0> + <highway_slope> * <prepass_start> -2 * $prepass_border)
	tan_theta = 0.674
	prepass_z_offset = (<prepass_mdl_top_width> / (<tan_theta> * <prepass_top_width> / 640))
	prepass_y_offset = ((360 - (<highway_start> + <prepass_start>)) * <prepass_z_offset> * <tan_theta> / 640)
	prepass_x_offset = (<x_offset> * <prepass_z_offset> * <tan_theta> / 640)
	prepass_y_scale = ((<prepass_mdl_bottom_width> - <prepass_mdl_top_width>) / (<prepass_mdl_height> * <highway_slope>))
	return prepass_offset = (<prepass_z_offset> * (0.0, 0.0, 1.0) + <prepass_y_offset> * (0.0, 1.0, 0.0) + <prepass_x_offset> * (-1.0, 0.0, 0.0)) prepass_scale = ((1.0, 0.0, 1.0) + <prepass_y_scale> * (0.0, 1.0, 0.0))
endscript

script create_highway_prepass 
	FormatText checksumname = highway_prepass_id 'highway_prepassp%p' p = <player> AddToStringLookup = true
	FormatText checksumname = container_id 'gem_notes_containerp%p' p = <player> AddToStringLookup = true
	FormatText checksumname = prepass_window_id 'prepass_windowp%p' p = <player> AddToStringLookup = true
	FormatText checksumname = sprite_id 'prepass_spritep%p' p = <player> AddToStringLookup = true
	FormatText checksumname = prepass_material 'prepass_materialp%p' p = <player> AddToStringLookup = true
	pos_table = ($highway_pos_table [(<player> -1)])
	hpos = ((0.0 - ((<pos_table>.highway_top_width) / 2.0)) * (1.0, 0.0))
	hdims = ((<pos_table>.highway_top_width) * (1.0, 0.0))
	DestroyMaterial name = <prepass_material>
	CreateMaterial {
		name = <prepass_material>
		template = HighwayPrepass_UI
		technique = Default
		MaterialProps = [
			{name = m_playerIndex FloatProperty = <player>}
			{name = m_sampDummy TextureProperty = `tex\models\Highway\Highway_Judy_fm_01.dds`}
		]
		texdicts = ($material_texdicts)
	}
	CreateScreenElement {
		parent = <container_id>
		id = <prepass_window_id>
		type = WindowElement
		viewport = bg_viewport
		viewportRenderPre = true
		just = [center top]
		Pos = (0.0, 0.0)
	}
	CreateScreenElement {
		parent = <prepass_window_id>
		id = <sprite_id>
		type = SpriteElement
		material = <prepass_material>
		scale = 1.0
		Pos = <hpos>
		dims = <hdims>
		just = [left top]
		pos_anchor = [center top]
	}
endscript

script destroy_highway_prepass 
endscript

script disable_highway_prepass 
endscript

script enable_highway_prepass 
endscript
start_2d_move = 0

script move_highway_2d 
	FormatText checksumname = highway_container_id 'highway_containerp%p' p = <player>
	<highway_container_id> :SE_SetProps alpha = 1
	get_num_non_vocals_players_onscreen
	get_non_vocalist_player_number player = <player>
	get_highway_pos_and_scale num_non_vocals_players = <num_non_vocals_players> non_vocalist_player = <non_vocalist_player> player = <player>
	<container_pos> = (<Pos> + (0.0, 720.0))
	highway_start_y = 720
	pos_start_orig = 0
	pos_add = -720
	pos_sub = 1.0
	pos_sub_add = -0.00044
	<Pos> = (((<container_pos>.(1.0, 0.0)) * (1.0, 0.0)) + (<highway_start_y> * (0.0, 1.0)))
	SetScreenElementProps id = <highway_container_id> Pos = <Pos>
	Change \{start_2d_move = 0}
	begin
	if ($start_2d_move = 1)
		break
	endif
	wait \{1
		gameframe}
	repeat
	GetFPS
	delta_time = (1.0 / <fps>)
	begin
	<Pos> = (((<container_pos>.(1.0, 0.0)) * (1.0, 0.0)) + (<highway_start_y> * (0.0, 1.0)))
	SetScreenElementProps id = <highway_container_id> Pos = <Pos>
	update_fade_point player = <player> offset = <Pos> got_offset = 1
	<highway_start_y> = (<highway_start_y> + (<pos_add> * <delta_time>))
	<pos_add> = (<pos_add> * <pos_sub>)
	<pos_sub> = (<pos_sub> + <pos_sub_add>)
	if (<highway_start_y> <= <pos_start_orig>)
		<Pos> = (((<container_pos>.(1.0, 0.0)) * (1.0, 0.0)) + (<pos_start_orig> * (0.0, 1.0)))
		SetScreenElementProps id = <highway_container_id> Pos = <Pos>
		break
	endif
	wait \{1
		gameframe}
	repeat
endscript

script move_highway_camera_to_default 
	Change \{start_2d_move = 1}
endscript

script disable_bg_viewport_properties 
	SetViewportProperties \{viewport = bg_viewport
		clear_colorbuffer = true}
	SetViewportProperties \{viewport = bg_viewport
		clear_depthstencilbuffer = true}
	if PrepassViewportExists \{viewport = bg_viewport}
		SetViewportProperties \{viewport = bg_viewport
			prepass = 0
			active = false}
		SetViewportProperties \{viewport = bg_viewport
			prepass = 1
			active = false}
	endif
endscript

script set_all_highway_props 
	<props> = <...>
	if ScreenElementExists \{id = gem_containerp1}
		SetScreenElementProps id = gem_containerp1 <props>
	endif
	if ScreenElementExists \{id = gem_containerp2}
		SetScreenElementProps id = gem_containerp2 <props>
	endif
	if ScreenElementExists \{id = gem_containerp3}
		SetScreenElementProps id = gem_containerp3 <props>
	endif
	if ScreenElementExists \{id = gem_containerp4}
		SetScreenElementProps id = gem_containerp4 <props>
	endif
	if ScreenElementExists \{id = highway_containerp1}
		SetScreenElementProps id = highway_containerp1 <props>
	endif
	if ScreenElementExists \{id = highway_containerp2}
		SetScreenElementProps id = highway_containerp2 <props>
	endif
	if ScreenElementExists \{id = highway_containerp3}
		SetScreenElementProps id = highway_containerp3 <props>
	endif
	if ScreenElementExists \{id = highway_containerp4}
		SetScreenElementProps id = highway_containerp4 <props>
	endif
	if ScreenElementExists \{id = HUD_2D_Containerp1}
		SetScreenElementProps id = HUD_2D_Containerp1 <props>
	endif
	if ScreenElementExists \{id = HUD_2D_Containerp2}
		SetScreenElementProps id = HUD_2D_Containerp2 <props>
	endif
	if ScreenElementExists \{id = HUD_2D_Containerp3}
		SetScreenElementProps id = HUD_2D_Containerp3 <props>
	endif
	if ScreenElementExists \{id = HUD_2D_Containerp4}
		SetScreenElementProps id = HUD_2D_Containerp4 <props>
	endif
	if ScreenElementExists \{id = nowbar_container_p1}
		SetScreenElementProps id = nowbar_container_p1 <props>
	endif
	if ScreenElementExists \{id = nowbar_container_p2}
		SetScreenElementProps id = nowbar_container_p2 <props>
	endif
	if ScreenElementExists \{id = nowbar_container_p3}
		SetScreenElementProps id = nowbar_container_p3 <props>
	endif
	if ScreenElementExists \{id = nowbar_container_p4}
		SetScreenElementProps id = nowbar_container_p4 <props>
	endif
	<player> = 1
	begin
	GetPlayerInfo <player> part
	if (<part> = vocals)
		VocalsHighway_GetId player = <player>
		if ScreenElementExists id = <vocals_highway_id>
			SetScreenElementProps id = <vocals_highway_id> <props>
		endif
		GetPlayerInfo <player> combo_meter_id
		if ScreenElementExists id = <combo_meter_id>
			<combo_meter_id> :SE_SetProps <props>
		endif
	endif
	<player> = (<player> + 1)
	repeat 4
endscript

script set_active_highway_props 
	<props> = <...>
	GetNumPlayersInGame \{on_screen}
	if (<num_players_shown> > 0)
		GetFirstPlayer \{on_screen}
		begin
		GetPlayerInfo <player> freeplay_state
		if NOT (<freeplay_state> = dropped)
			if PlayerInfoEquals <player> part = vocals
				VocalsHighway_GetId player = <player>
				if ScreenElementExists id = <vocals_highway_id>
					SetScreenElementProps id = <vocals_highway_id> <props>
				endif
				GetPlayerInfo <player> combo_meter_id
				if ScreenElementExists id = <combo_meter_id>
					<combo_meter_id> :SE_SetProps <props>
				endif
			else
				FormatText checksumname = container_id 'gem_containerp%p' p = <player>
				if ScreenElementExists id = <container_id>
					SetScreenElementProps id = <container_id> <props>
				endif
				FormatText checksumname = container_id 'highway_containerp%p' p = <player>
				if ScreenElementExists id = <container_id>
					SetScreenElementProps id = <container_id> <props>
				endif
				FormatText checksumname = container_id 'HUD_2D_Containerp%p' p = <player>
				if ScreenElementExists id = <container_id>
					SetScreenElementProps id = <container_id> <props>
				endif
				FormatText checksumname = container_id 'nowbar_container_p%p' p = <player>
				if ScreenElementExists id = <container_id>
					SetScreenElementProps id = <container_id> <props>
				endif
			endif
		endif
		GetNextPlayer on_screen player = <player>
		repeat <num_players_shown>
	endif
endscript

script set_all_highway_prepass_props 
	<props> = <...>
	if ScreenElementExists \{id = prepass_windowp1}
		SetScreenElementProps id = prepass_windowp1 <props>
	endif
	if ScreenElementExists \{id = prepass_windowp2}
		SetScreenElementProps id = prepass_windowp2 <props>
	endif
	if ScreenElementExists \{id = prepass_windowp3}
		SetScreenElementProps id = prepass_windowp3 <props>
	endif
	if ScreenElementExists \{id = prepass_windowp4}
		SetScreenElementProps id = prepass_windowp4 <props>
	endif
endscript

script set_active_highway_prepass_props 
	<props> = <...>
	GetNumPlayersInGame \{on_screen}
	if (<num_players_shown> > 0)
		GetFirstPlayer \{on_screen}
		begin
		GetPlayerInfo <player> freeplay_state
		if NOT (<freeplay_state> = dropped)
			if NOT PlayerInfoEquals <player> part = vocals
				FormatText checksumname = container_id 'prepass_windowp%p' p = <player>
				if ScreenElementExists id = <container_id>
					SetScreenElementProps id = <container_id> <props>
				endif
			endif
		endif
		GetNextPlayer on_screen player = <player>
		repeat <num_players_shown>
	endif
endscript

script disable_bg_viewport 
	<hide_highway> = true
	if NOT RetailBuild
		if ($alternate_viewer_hud_behavior = 1)
			<hide_highway> = false
		endif
	endif
	if (<hide_highway> = true)
		set_all_highway_prepass_props \{alpha = 0}
		set_all_highway_props \{alpha = 0
			time = 0.4}
	endif
	if NOT GotParam \{no_cameras}
		kill_dummy_bg_camera
	endif
	if ScreenElementExists \{id = ui_clip_root}
		ui_clip_root :SE_SetProps \{hide}
	endif
	disable_bg_viewport_properties
	if NOT GotParam \{no_cameras}
		SetActiveCamera \{id = viewer_cam
			viewport = bg_viewport}
	endif
endscript

script enable_bg_viewport_properties 
	if PrepassViewportExists \{viewport = bg_viewport}
		SetViewportProperties \{viewport = bg_viewport
			allow_view_dependent_intramesh_sort = 1}
		SetViewportProperties \{viewport = bg_viewport
			clear_colorbuffer = false}
		SetViewportProperties \{viewport = bg_viewport
			clear_depthstencilbuffer = false}
		SetViewportProperties \{viewport = bg_viewport
			no_resolve_depthstencilbuffer = true}
		SetViewportProperties \{viewport = bg_viewport
			no_resolve_colorbuffer = true}
		SetViewportProperties \{viewport = bg_viewport
			prepass = 0
			active = true}
		SetViewportProperties \{viewport = bg_viewport
			prepass = 1
			active = true}
	else
		SetViewportProperties \{viewport = bg_viewport
			allow_view_dependent_intramesh_sort = 1}
		SetViewportProperties \{viewport = bg_viewport
			clear_colorbuffer = true}
		SetViewportProperties \{viewport = bg_viewport
			clear_depthstencilbuffer = true}
		SetViewportProperties \{viewport = bg_viewport
			no_resolve_depthstencilbuffer = true}
		SetViewportProperties \{viewport = bg_viewport
			no_resolve_colorbuffer = true}
	endif
	TOD_Proxim_Update_LightFX_Viewport \{fxParam = $Default_TOD_Manager
		viewport = bg_viewport
		time = 0}
	Venue_ScreenFX
endscript

script enable_bg_viewport 
	set_all_highway_props \{alpha = 1}
	enable_bg_viewport_properties
	ui_clip_root :SE_SetProps \{unhide}
endscript

script destroy_bg_viewport 
endscript
Highway_Fader_Params = {
	style = highway_fader
	rt_size = (1280.0, 720.0)
	rt_offset = (0.0, 0.0)
	clip_dims = (256.0, 256.0)
	clip_offset = (0.0, -64.0)
}
Highway_Fader_Params_2p = {
	style = highway_fader_2p
	rt_size = (1280.0, 720.0)
	rt_offset = (0.0, 0.0)
	clip_dims = (1024.0, 200.0)
	clip_offset = (0.0, 0.0)
}
Highway_Fader_Params_ps3 = {
	style = highway_fader_ps3
	rt_size = (1280.0, 720.0)
	rt_offset = (0.0, 0.0)
	clip_dims = (256.0, 256.0)
	clip_offset = (0.0, -64.0)
}
Highway_Fader_Params_2p_ps3 = {
	style = highway_fader_2p_ps3
	rt_size = (1280.0, 720.0)
	rt_offset = (0.0, 0.0)
	clip_dims = (832.0, 200.0)
	clip_offset = (0.0, 0.0)
}

script setup_bg_viewport 
	enable_bg_viewport_properties
endscript

script setup_bg_viewport_boot 
	printf \{qs(0x0fea7055)}
	destroy_bg_viewport
	GetNumPlayersInGame
	if IsXenonOrWinDX
		if (<num_players> = 1)
			AddParams \{$Highway_Fader_Params}
		else
			AddParams \{$Highway_Fader_Params_2p}
		endif
	else
		if (<num_players> = 1)
			AddParams \{$Highway_Fader_Params_ps3}
		else
			AddParams \{$Highway_Fader_Params_2p_ps3}
		endif
	endif
	Pos = (2000.0, 300.0)
	Pos = (<Pos> + <clip_offset>)
	bg_pos = (<clip_dims> * 0.5 - <Pos> + <rt_offset>)
	if NOT ScreenElementExists \{id = ui_clip_root}
		CreateScreenElement {
			parent = root_window
			type = WindowElement
			id = ui_clip_root
			just = [center center]
			Pos = <Pos>
			dims = <clip_dims>
		}
		CreateScreenElement {
			parent = ui_clip_root
			type = viewportelement
			id = bg_viewport
			texture = viewport0
			Pos = <bg_pos>
			just = [left top]
			dims = <rt_size>
			rgba = [128 128 128 255]
			alpha = 1
			capability = $sfx_all_params
			draw_debug_lines = true
			style = fullscreen_nomsaa
			framerate = 30
			framemask = 3
			has_ui = true
			has_ui_only = false
		}
	endif
	enable_bg_viewport_properties
	printf \{qs(0xbf065090)}
endscript

script is_highway_morphing 
	RequireParams \{[
			player
		]
		all}
	FormatText checksumname = hw_container_id 'highway_containerp%p' p = <player>
	is_morphing = 0
	if ScreenElementExists id = <hw_container_id>
		<hw_container_id> :GetTags
		if (<curr_x_pos> != <dest_x_pos>)
			is_morphing = 1
		elseif (<curr_y_pos> != <dest_y_pos>)
			is_morphing = 1
		endif
	endif
	return is_morphing = <is_morphing>
endscript

script highway_pulse_multiplier_loss \{player = 1
		Multiplier = 1}
	is_highway_morphing player = <player>
	if (<is_morphing> = 1)
		return
	endif
	time = 0.1
	switch <Multiplier>
		case 1
		push_pos = (0.0, 3.0)
		case 2
		push_pos = (0.0, 4.0)
		case 3
		push_pos = (0.0, 10.0)
		case 4
		push_pos = (0.0, 15.0)
		time = 0.11
		default
		push_pos = (0.0, 3.0)
	endswitch
	if (
			($game_mode = p1_quickplay)
			|| ($game_mode = gh4_p1_career)
			|| ($game_mode = tutorial)
			|| ($game_mode = practice)
		)
	else
		<push_pos> = (<push_pos> * 0.6)
	endif
	ExtendCrcPlayer highway_container <player> out = container_id
	if ScreenElementExists id = <container_id>
		if <container_id> :GetSingleTag doing_pulse
		else
			<container_id> :SetTags doing_pulse = 1
			OnExitRun highway_pulse_multiplier_loss_cleanup params = {container_id = <container_id>}
			GetScreenElementPosition id = <container_id>
			original_position = <ScreenElementPos>
			GetRandomValue \{name = random_x
				a = -7
				b = 7
				integer}
			LegacyDoScreenElementMorph {id = <container_id> Pos = (<original_position> + <push_pos> + ((1.0, 0.0) * <random_x>)) just = [center bottom] time = <time>}
			wait <time> seconds
			GetRandomValue \{name = random_x
				a = -7
				b = 7
				integer}
			LegacyDoScreenElementMorph {id = <container_id> Pos = (<original_position> - ((1.0, 0.0) * <random_x>)) just = [center bottom] time = <time>}
			wait <time> seconds
			GetRandomValue \{name = random_x
				a = -5
				b = 5
				integer}
			LegacyDoScreenElementMorph {id = <container_id> Pos = (<original_position> + (<push_pos> * 0.4) + ((1.0, 0.0) * <random_x>)) just = [center bottom] time = <time>}
			wait <time> seconds
			GetRandomValue \{name = random_x
				a = -5
				b = 5
				integer}
			LegacyDoScreenElementMorph {id = <container_id> Pos = (<original_position> - ((1.0, 0.0) * <random_x>)) just = [center bottom] time = <time>}
			wait <time> seconds
			GetRandomValue \{name = random_x
				a = -3
				b = 3
				integer}
			LegacyDoScreenElementMorph {id = <container_id> Pos = (<original_position> + (<push_pos> * 0.2) + ((1.0, 0.0) * <random_x>)) just = [center bottom] time = <time>}
			wait <time> seconds
			LegacyDoScreenElementMorph {id = <container_id> Pos = <original_position> just = [center bottom] time = <time>}
		endif
	endif
endscript

script highway_pulse_multiplier_loss_cleanup 
	<container_id> :RemoveTags [doing_pulse]
endscript

script highway_visible 
	Change \{highwayvisible = on}
endscript

script highway_invisible 
	Change \{highwayvisible = off}
endscript

script get_non_vocalist_player_number 
	GetNumPlayersInGame \{on_screen}
	if ($musicstudio_jamroom_highways != 0)
		<num_players_shown> = $musicstudio_jamroom_highways
		return non_vocalist_player = <player>
	endif
	<non_vocalist_player> = 0
	<i> = 1
	GetNumPlayersInGame \{on_screen}
	if (<num_players_shown> > 0)
		GetFirstPlayer \{on_screen
			out = i}
		begin
		if NOT PlayerInfoEquals <i> part = vocals
			<non_vocalist_player> = (<non_vocalist_player> + 1)
		endif
		if (<i> = <player>)
			if PlayerInfoEquals <i> part = vocals
				ScriptAssert 'player %i is vocals' i = <i>
			endif
			return non_vocalist_player = <non_vocalist_player>
		endif
		GetNextPlayer on_screen player = <i> out = i
		repeat <num_players_shown>
	endif
	ScriptAssert \{'No non-vocalist found!'}
endscript

script player_is_lowest_numbered_guitar_or_bass 
	RequireParams \{[
			player
		]
		all}
	if (<player> > 1)
		<i> = 1
		begin
		if ((PlayerInfoEquals <i> part = guitar) || (PlayerInfoEquals <i> part = bass))
			return \{false}
		endif
		<i> = (<i> + 1)
		repeat (<player> - 1)
	endif
	return \{true}
endscript

script tempo_light_on 
endscript

script highway_streak_glow \{enabled = 1}
	if PlayerInfoEquals <player> part = vocals
		VocalsHighway_GetId player = <player>
		if ScreenElementExists id = <vocals_highway_id>
			if (<enabled> = 1)
				<vocals_highway_id> :SE_SetProps band_streak_lines_alpha = 1.0
			else
				<vocals_highway_id> :SE_SetProps band_streak_lines_alpha = 0.0
			endif
		endif
	else
		FormatText checksumname = left_glow 'Sidebar_NSGLOW_leftp%p' p = <player> AddToStringLookup = true
		FormatText checksumname = right_glow 'Sidebar_NSGLOW_rightp%p' p = <player> AddToStringLookup = true
		if ScreenElementExists id = <left_glow>
			if (<enabled> = 1)
				<left_glow> :SE_SetProps unhide
			else
				<left_glow> :SE_SetProps hide
			endif
		endif
		if ScreenElementExists id = <right_glow>
			if (<enabled> = 1)
				<right_glow> :SE_SetProps unhide
			else
				<right_glow> :SE_SetProps hide
			endif
		endif
	endif
endscript

script highway_grace_period_start 
	RequireParams \{[
			player
		]
		all}
	SetPlayerInfo <player> grace_period_on = 1
	LaunchGemEvent event = grace_period_on player = <player>
endscript

script highway_grace_period_end 
	RequireParams \{[
			player
		]
		all}
	SetPlayerInfo <player> grace_period_on = 0
	LaunchGemEvent event = grace_period_off player = <player>
endscript

script create_highway_root_window 
	window_id = highway_root_window
	if ScreenElementExists id = <window_id>
		DestroyScreenElement id = <window_id>
	endif
	CreateScreenElement {
		type = ContainerElement
		id = <window_id>
		parent = root_window
		Pos = (640.0, 0.0)
		just = [center top]
	}
endscript

script destroy_highway_root_window 
	if ScreenElementExists id = <window_id>
		DestroyScreenElement id = <window_id>
	endif
endscript

script update_highway_scale \{player = 1
		x_scale_factor = 1.0
		y_scale_factor = 1.0
		extra_offset_factor = 0.0
		jamroom_highway = 0
		lerping_factor = 1.0
		target_player_morph0 = 0
		target_player_morph1 = 1
		target_player_morph_lerp_val = 0.0
		MorphTarget = 0}
	ExtendedChecksum = null
	ScreenElementPos = (0.0, 0.0)
	highway_height = 0.0
	highway_playline = 0.0
	bottom_width = 0.0
	rockmeter_pos = (0.0, 0.0)
	rockmeter_scale = 0.0
	ns_meter_pos = (0.0, 0.0)
	ns_meter_scale = 0.0
	startY = 0.0
	hpos = (0.0, 0.0)
	hdims = (0.0, 0.0)
	wof = 0.0
	extra_bottom_x_scale = ((1.0 + $highway_guitar1.widthOffsetFactor + <extra_offset_factor>) / (1.0 + $highway_guitar1.widthOffsetFactor))
	dan_tweak = 1.07
	special_extra_bottom_x_scale = ((1.0 + $highway_guitar1.widthOffsetFactor + (<extra_offset_factor> * <dan_tweak>)) / (1.0 + $highway_guitar1.widthOffsetFactor))
	<pos_index> = (<player> -1)
	<pos_table> = ($highway_pos_table [<pos_index>])
	if NOT StructureContains structure = <pos_table> widthOffsetFactor
		return
	endif
	<wof> = (<pos_table>.widthOffsetFactor + <extra_offset_factor>)
	<scale_pair> = (((1.0, 0.0) * <x_scale_factor>) + ((0.0, 1.0) * <y_scale_factor>))
	<highway_height> = (<pos_table>.highway_height)
	<highway_playline> = (<pos_table>.highway_playline)
	<bottom_width> = ((<pos_table>.highway_top_width) + ((<pos_table>.highway_top_width) * <wof>))
	<rockmeter_pos> = (<pos_table>.rockmeter_pos)
	<rockmeter_scale> = (<pos_table>.rockmeter_scale)
	<ns_meter_pos> = (<pos_table>.ns_meter_pos)
	<ns_meter_scale> = (<pos_table>.ns_meter_scale)
	<highway_playline> = (<pos_table>.highway_playline)
	<startY> = (<highway_playline> - (<pos_table>.highway_height))
	ExtendCRCWithInteger checksum = gem_containerp integer = <player>
	gem_container = <ExtendedChecksum>
	if ScreenElementExists id = <gem_container>
		FastGetScreenElementPosition id = <gem_container>
		x = (<ScreenElementPos>.(1.0, 0.0))
		y = (<highway_height> - (<highway_height> * <y_scale_factor>))
		p = (((1.0, 0.0) * <x>) + ((0.0, 1.0) * <y>))
		SetScreenElementProps id = <gem_container> Pos = <p>
	endif
	<height> = (<pos_table>.highway_height)
	if (<MorphTarget> = 1)
		CreateRescalePosTableTarget {
			rows = $highway_lines
			normal_rows = $real_highway_lines
			startY = <startY>
			height = <height>
			scaleY = <y_scale_factor>
			pos_index = <pos_index>
			extraWidthOffsetFactor = <extra_offset_factor>
			extraBottomXScale = <extra_bottom_x_scale>
			heightOffsetFactor = <heightOffsetFactor>
			heightOffsetExp = <heightOffsetExp>
			target_player_morph0 = <target_player_morph0>
			target_player_morph1 = <target_player_morph1>
			target_player_morph_lerp_val = <target_player_morph_lerp_val>
		}
		return
	else
		RescalePosTableUsingMorphTargets {
			rows = $highway_lines
			normal_rows = $real_highway_lines
			startY = <startY>
			height = <height>
			scaleY = <y_scale_factor>
			pos_index = <pos_index>
			extraWidthOffsetFactor = <extra_offset_factor>
			extraBottomXScale = <extra_bottom_x_scale>
			heightOffsetFactor = <heightOffsetFactor>
			heightOffsetExp = <heightOffsetExp>
			lerping_factor = <lerping_factor>
			target_player_morph0 = <target_player_morph0>
			target_player_morph1 = <target_player_morph1>
			target_player_morph_lerp_val = <target_player_morph_lerp_val>
		}
	endif
	hpos = ((0.0 - ((<x_scale_factor> * (<pos_table>.highway_top_width)) / 2.0)) * (1.0, 0.0))
	hdims = (((<pos_table>.highway_top_width) * <x_scale_factor>) * (1.0, 0.0))
	hscale = (((1.0, 0.0) * <x_scale_factor>) + (0.0, 1.0))
	ExtendCRCWithInteger checksum = Highway_2Dp integer = <player>
	highway_sprite = <ExtendedChecksum>
	SetScreenElementProps id = <highway_sprite> scale = <hscale> Pos = <hpos>
	ExtendCRCWithInteger checksum = fretbar_containerp integer = <player>
	fretbar_id = <ExtendedChecksum>
	SetScreenElementProps id = <fretbar_id> scale = <hscale>
	height = 0.0
	height = (<pos_table>.highway_height)
	top_width = 0.0
	top_width = (<pos_table>.highway_top_width)
	scaled_height = (<height> * <y_scale_factor>)
	scaled_top_width = (<top_width> * <x_scale_factor>)
	<scaled_bottom_width> = (<scaled_top_width> + (<scaled_top_width> * <wof>))
	shbx = (0.0 - (<scaled_bottom_width> / 2.0))
	adj = ((<scaled_bottom_width> - <scaled_top_width>) / 2.0)
	opp = <height>
	<atan> = 0.0
	Atan2 x = <opp> y = <adj>
	angle = <atan>
	scaled_lpos = ((($sidebar_x [(<player> -1)] * <x_scale_factor> * <special_extra_bottom_x_scale>) * (1.0, 0.0)) + (($sidebar_y [(<player> -1)]) * (0.0, 1.0)))
	langle = ($sidebar_angle [(<player> -1)])
	ExtendCRCWithInteger checksum = sidebar_container_leftp integer = <player>
	sidebar_left_container = <ExtendedChecksum>
	if ScreenElementExists id = <sidebar_left_container>
		SetScreenElementProps id = <sidebar_left_container> rot_angle = <angle> Pos = <scaled_lpos>
	endif
	scaled_rpos = ((((0.0 - $sidebar_x [(<player> -1)]) * <x_scale_factor> * <special_extra_bottom_x_scale>) * (1.0, 0.0)) + ($sidebar_y [(<player> -1)] * (0.0, 1.0)))
	rangle = (0.0 - <angle>)
	ExtendCRCWithInteger checksum = sidebar_container_rightp integer = <player>
	sidebar_right_container = <ExtendedChecksum>
	if ScreenElementExists id = <sidebar_right_container>
		SetScreenElementProps id = <sidebar_right_container> Pos = <scaled_rpos> rot_angle = (0.0 - <angle>)
	endif
	base_width = ((<bottom_width> - <top_width>) / 2)
	<percent_change_in_y> = (<y> / <highway_height>)
	xc = ((2 * <base_width>) * <percent_change_in_y>)
	nbw = (<bottom_width> - <xc>)
	pcx = (<nbw> / <bottom_width>)
	nowbar_scale = (((<pcx> * <x_scale_factor> * <special_extra_bottom_x_scale>) * (1.0, 0.0)) + ((<pcx> * <x_scale_factor> * <special_extra_bottom_x_scale>) * (0.0, 1.0)))
	nb_x_scale = (<pcx> * <x_scale_factor> * <special_extra_bottom_x_scale>)
	nb_y_scale = <y_scale_factor>
	nb_scale_ar = (<nb_y_scale> / <nb_x_scale>)
	FastGetScreenElementPosition id = <gem_container>
	x = (<ScreenElementPos>.(1.0, 0.0))
	y = (<highway_playline> - (<highway_playline> * (<nowbar_scale>.(0.0, 1.0))))
	p = (((1.0, 0.0) * <x>) + ((0.0, 1.0) * <y>))
	if (<jamroom_highway> = 0)
		ExtendCRCWithInteger checksum = nowbar_container_p integer = <player>
		nowbar_id = <ExtendedChecksum>
		if ScreenElementExists id = <nowbar_id>
			SetScreenElementProps id = <nowbar_id> scale = <nowbar_scale> Pos = <p>
		endif
	endif
	y = (<highway_height> - (<highway_height> * <y_scale_factor>))
	offset = ((0.0, 1.0) * (-1 * <y>))
	scale = (((1.0, 0.0) * (<rockmeter_scale> * <x_scale_factor>)) + ((0.0, 1.0) * (<rockmeter_scale> * <y_scale_factor>)))
	ExtendCRCWithInteger checksum = sidebar_left_rock_meterp integer = <player>
	left_rock_id = <ExtendedChecksum>
	Pos = (<rockmeter_pos> + <offset>)
	if ScreenElementExists id = <left_rock_id>
		<left_rock_id> :SE_SetProps Pos = <Pos> scale = <scale>
	endif
	<scale_pair> = (((1.0, 0.0) * (-1 * (<scale>.(1.0, 0.0)))) + ((0.0, 1.0) * (<scale>.(0.0, 1.0))))
	<rockmeter_pos> = (((1.0, 0.0) * (-1 * (<rockmeter_pos>.(1.0, 0.0)))) + ((0.0, 1.0) * (<rockmeter_pos>.(0.0, 1.0))))
	ExtendCRCWithInteger checksum = sidebar_right_sp_meterp integer = <player>
	right_sp_id = <ExtendedChecksum>
	Pos = (<rockmeter_pos> + <offset>)
	if ScreenElementExists id = <right_sp_id>
		<right_sp_id> :SE_SetProps Pos = <Pos> scale = <scale_pair>
	endif
	ExtendCRCWithInteger checksum = sidebar_right_ns_meterp integer = <player>
	right_ns_id = <ExtendedChecksum>
	Pos = (<ns_meter_pos> + (0.5 * <offset>))
	if (<x_scale_factor> < <y_scale_factor>)
		sf = <x_scale_factor>
	else
		sf = <y_scale_factor>
	endif
	scale = (((1.0, 0.0) * (<ns_meter_scale> * <sf>)) + ((0.0, 1.0) * (<ns_meter_scale> * <sf>)))
	if ScreenElementExists id = <right_ns_id>
		<right_ns_id> :SE_SetProps Pos = <Pos> scale = <scale>
	endif
	ExtendCRCWithInteger checksum = gem_notes_containerp integer = <player>
	gem_notes_id = <ExtendedChecksum>
	scale = ((0.0, 1.0) + ((1.0, 0.0) * <x_scale_factor>))
	<gem_notes_id> :SE_SetProps scale = <scale>
	update_whammy_angles player = <player> x_scale = <x_scale_factor> extra_offset_factor = <extra_offset_factor> nb_scale_ar = <nb_scale_ar>
	adjust_highway_rails_to_scale player = <player>
	update_fade_point player = <player>
	heightOffsetFactor = 0.0
	heightOffsetExp = 0.0
endscript

script update_whammy_angles \{player = 1
		x_scale = 1.0
		y_scale = 1.0
		extra_offset_factor = 0.0}
	top_width = 0.0
	wof = 0.0
	highway_playline = 0
	height = 0.0
	scale = ((<x_scale> * (1.0, 0.0)) + (<y_scale> * (0.0, 1.0)))
	pos_index = (<player> - 1)
	pos_table = ($highway_pos_table [<pos_index>])
	wof = (<pos_table>.widthOffsetFactor + <extra_offset_factor>)
	height = (<pos_table>.highway_height * <y_scale>)
	top_width = ((<pos_table>.highway_top_width) * <x_scale>)
	gts = (<top_width> / 5.0)
	highway_playline = (<pos_table>.highway_playline)
	htx = (0.0 - (<top_width> / 2.0))
	hbw = (<top_width> + (<top_width> * <wof>))
	hbx = (0.0 - (<hbw> / 2.0))
	gbs = (<hbw> / 5.0)
	startY = (<highway_playline> - <height>)
	rows = $highway_lines
	normal_rows = $real_highway_lines
	if NOT PlayerInfoEquals <player> part = Drum
		gsx = (<htx> + (<gts> / 2.0) + (<gts> * 0.0))
		rsx = (<htx> + (<gts> / 2.0) + (<gts> * 1.0))
		ysx = (<htx> + (<gts> / 2.0) + (<gts> * 2.0))
		bsx = (<htx> + (<gts> / 2.0) + (<gts> * 3.0))
		osx = (<htx> + (<gts> / 2.0) + (<gts> * 4.0))
		psx = (<htx> + (<gts> / 2.0) + (<gts> * -1.0))
	else
		if UseFourLaneHighway player = <player>
			gts = (<top_width> / 4.0)
		endif
		rsx = (<htx> + (<gts> * 0.5))
		ysx = (<rsx> + <gts>)
		bsx = (<ysx> + <gts>)
		if NOT UseFourLaneHighway player = <player>
			osx = (<bsx> + <gts>)
			gsx = (<osx> + <gts>)
		else
			osx = (<bsx> + (10 * <gts>))
			gsx = (<bsx> + <gts>)
		endif
		psx = (<htx> + ((<pos_table>.highway_top_width) * 0.5))
	endif
	if NOT PlayerInfoEquals <player> part = Drum
		gex = (<hbx> + (<gbs> / 2.0) + (<gbs> * 0.0))
		rex = (<hbx> + (<gbs> / 2.0) + (<gbs> * 1.0))
		yex = (<hbx> + (<gbs> / 2.0) + (<gbs> * 2.0))
		bex = (<hbx> + (<gbs> / 2.0) + (<gbs> * 3.0))
		oex = (<hbx> + (<gbs> / 2.0) + (<gbs> * 4.0))
		pex = (<hbx> + (<gbs> / 2.0) + (<gbs> * 2.0))
		pex1 = (<hbx> + (<gbs> / 2.0) + (<gbs> * -0.5))
		pex2 = (<hbx> + (<gbs> / 2.0) + (<gbs> * 4.5))
	else
		if UseFourLaneHighway player = <player>
			gbs = (<hbw> / 4.0)
		endif
		rex = (<hbx> + (<gbs> * 0.5))
		yex = (<rex> + <gbs>)
		bex = (<yex> + <gbs>)
		if NOT UseFourLaneHighway player = <player>
			oex = (<bex> + <gbs>)
			gex = (<oex> + <gbs>)
		else
			oex = (<bex> + (10 * <gbs>))
			gex = (<bex> + <gbs>)
		endif
		pex = (<hbx> + (<hbw> * 0.5))
		pex1 = (<hbx> + (<gbs> * -0.15))
		pex2 = (<gex> + (<gbs> * 0.65000004))
	endif
	<atan> = 0.0
	Atan2 x = (<pos_table>.highway_height) y = (<gsx> - <gex>)
	ga = <atan>
	Atan2 x = (<pos_table>.highway_height) y = (<rsx> - <rex>)
	ra = <atan>
	Atan2 x = (<pos_table>.highway_height) y = (<ysx> - <yex>)
	ya = <atan>
	Atan2 x = (<pos_table>.highway_height) y = (<bsx> - <bex>)
	ba = <atan>
	Atan2 x = (<pos_table>.highway_height) y = (<osx> - <oex>)
	oa = <atan>
	Atan2 x = (<pos_table>.highway_height) y = (<psx> - <pex>)
	pa = <atan>
	if PlayerInfoEquals <player> part = Drum
		UpdateButtonAngleData player = <player> array = button_models Color = red angle = <ra> left_angle = <ra>
		UpdateButtonAngleData player = <player> array = button_models Color = yellow angle = <ya> left_angle = <ya>
		UpdateButtonAngleData player = <player> array = button_models Color = blue angle = <ba> left_angle = <ba>
		UpdateButtonAngleData player = <player> array = button_models Color = orange angle = <oa> left_angle = <oa>
		UpdateButtonAngleData player = <player> array = button_models Color = green angle = <ga> left_angle = <ga>
		UpdateButtonAngleData player = <player> array = button_models Color = white angle = <pa> left_angle = <pa>
	else
		UpdateButtonAngleData player = <player> array = button_models Color = green angle = <ga> left_angle = <oa>
		UpdateButtonAngleData player = <player> array = button_models Color = red angle = <ra> left_angle = <ba>
		UpdateButtonAngleData player = <player> array = button_models Color = yellow angle = <ya> left_angle = <ya>
		UpdateButtonAngleData player = <player> array = button_models Color = blue angle = <ba> left_angle = <ra>
		UpdateButtonAngleData player = <player> array = button_models Color = orange angle = <oa> left_angle = <ga>
		UpdateButtonAngleData player = <player> array = button_models Color = white angle = <pa> left_angle = <pa>
	endif
	UpdateWhammyAngles player = <player>
	if ((PlayerInfoEquals <player> part = guitar) || (PlayerInfoEquals <player> part = bass))
		updateStringAngles player = <player> nb_scale_ar = <nb_scale_ar>
	endif
endscript

script updateStringAngles \{player = 1}
	color_string = ''
	array_size = 0
	FastGetArraySize \{array = $gem_colors}
	array_count = 0
	begin
	Color = ($gem_colors [<array_count>])
	if StructureContains structure = (($button_up_models [(<player> -1)]).<Color>) name = name
		<color_string> = (($button_up_models [(<player> -1)]).<Color>.name_string)
		ExtendedChecksum = ``
		ExtendCRCWithString checksum = <ExtendedChecksum> string = <color_string>
		ExtendCRCWithString checksum = <ExtendedChecksum> string = '_stringp'
		ExtendCRCWithInteger checksum = <ExtendedChecksum> integer = <player>
		name_string = <ExtendedChecksum>
		ExtendedChecksum = ``
		ExtendCRCWithString checksum = <ExtendedChecksum> string = <color_string>
		ExtendCRCWithString checksum = <ExtendedChecksum> string = '_touch_glowp'
		ExtendCRCWithInteger checksum = <ExtendedChecksum> integer = <player>
		name_touch_glow = <ExtendedChecksum>
		if (<Color> != white)
			get_new_string_scale player = <player> string_id = <name_string> nb_scale_diff = <nb_scale_ar>
			SetScreenElementProps {
				id = <name_string>
				rot_angle = (($button_models [(<player> -1)]).<Color>.angle)
				scale = <string_scale>
			}
			props = ($touch_glow_props)
			if ScreenElementExists id = <name_touch_glow>
				SetScreenElementProps {
					id = <name_touch_glow>
					rot_angle = ((($button_models [(<player> -1)]).<Color>.angle) + (<props> [<array_count>].rot_offset))
				}
			endif
		endif
	endif
	array_count = (<array_count> + 1)
	repeat <array_size>
endscript

script get_new_string_scale 
	RequireParams \{[
			string_id
			nb_scale_diff
			player
		]
		all}
	pos_index = (<player> - 1)
	<string_scale> = ((((($highway_pos_table [<pos_index>])).string_scale_x) * (1.0, 0.0)) + (((($highway_pos_table [<pos_index>])).string_scale_y) * (0.0, 1.0)))
	new_string_scale = (((<string_scale>.(1.0, 0.0)) * (1.0, 0.0)) + ((<string_scale>.(0.0, 1.0) * <nb_scale_diff>) * (0.0, 1.0)))
	return string_scale = <new_string_scale>
endscript

script update_highway_value \{dest = 0.0
		curr = 0.0
		max_delta = 0.0}
	gap = (<dest> - <curr>)
	if (<gap> < 0.0)
		abs_gap = (-1.0 * <gap>)
	else
		abs_gap = <gap>
	endif
	if (<gap> = 0.0)
		next = <dest>
		changed = false
	elseif (<max_delta> > <abs_gap>)
		next = <dest>
		changed = true
	else
		delta = (<max_delta> * <gap> / <abs_gap>)
		next = (<curr> + <delta>)
		changed = true
	endif
	return next = <next> changed = <changed>
endscript

script calculate_y_pos_factor_from_lerp_factor \{lerping_factor = 0.0}
	t = (1.0 - <lerping_factor>)
	k = 1.5
	base_exp = 4.482
	exp = 0.0
	MathExp x = (<k> * <t> * <t>)
	y_pos_factor = (1.0 - (<t> * <exp> / <base_exp>))
	return y_pos_factor = <y_pos_factor>
endscript
delta_lerp = 0.02
g_has_inited_highway_scale_targets = 0

script init_morph_targets \{jamroom_highway = 0}
	player_target_create_idx = 0
	begin
	morph_struct0 = (($highway_scale_chart) [(<player_target_create_idx>)])
	update_highway_scale {
		player = (<player_target_create_idx> + 1)
		x_scale_factor = (<morph_struct0>.hw_x_scale)
		y_scale_factor = (<morph_struct0>.hw_y_scale)
		extra_offset_factor = (<morph_struct0>.extra_offset_factor)
		heightOffsetFactor = (<morph_struct0>.perspectivefact)
		heightOffsetExp = (<morph_struct0>.perspectiveexp)
		jamroom_highway = <jamroom_highway>
		MorphTarget = 1
	}
	<player_target_create_idx> = (<player_target_create_idx> + 1)
	repeat 4
endscript

script GetObjectsTags \{objID = None}
	<objID> :GetTags
	return <...>
endscript

script highway_scale_manager \{jamroom_highway = 0
		player = 1}
	GameMode_GetType
	objID = None
	Obj_GetID
	if (($g_has_inited_highway_scale_targets) = 0)
		init_morph_targets jamroom_highway = <jamroom_highway>
		Change \{g_has_inited_highway_scale_targets = 1}
	endif
	start_x_scale = 0.0
	dest_x_scale = 0.0
	start_y_scale = 0.0
	dest_y_scale = 0.0
	start_extra_offset_factor = 0.0
	dest_extra_offset_factor = 0.0
	start_x_pos = 0.0
	dest_x_pos = 0.0
	start_heightOffsetFactor = 0.0
	dest_heightOffsetFactor = 0.0
	start_heightOffsetExp = 0.0
	dest_heightOffsetExp = 0.0
	start_y_pos = 0.0
	dest_y_pos = 0.0
	y_pos_factor = 0.0
	next = 0.0
	target_player_morph_lerp_val = 0.0
	begin
	TagValue = 0.0
	if GetFloatTag objectname = <objID> TagName = lerping_factor
		lerping_factor = <TagValue>
		if NOT (<lerping_factor> = 1.0)
			GetObjectsTags objID = <objID>
			update_highway_value dest = 1 curr = <lerping_factor> max_delta = ($delta_lerp)
			lerping_factor = <next>
			result = 0.0
			FastLinearMap from = <start_x_scale> to = <dest_x_scale> basedOn = <lerping_factor> lowerBound = 0.0 upperBound = 1.0
			next_x_scale = <result>
			FastLinearMap from = <start_y_scale> to = <dest_y_scale> basedOn = <lerping_factor> lowerBound = 0.0 upperBound = 1.0
			next_y_scale = <result>
			FastLinearMap from = <start_extra_offset_factor> to = <dest_extra_offset_factor> basedOn = <lerping_factor> lowerBound = 0.0 upperBound = 1.0
			next_extra_offset_factor = <result>
			FastLinearMap from = <start_x_pos> to = <dest_x_pos> basedOn = <lerping_factor> lowerBound = 0.0 upperBound = 1.0
			next_x_pos = <result>
			FastLinearMap from = <start_heightOffsetFactor> to = <dest_heightOffsetFactor> basedOn = <lerping_factor> lowerBound = 0.0 upperBound = 1.0
			next_heightOffsetFactor = <result>
			FastLinearMap from = <start_heightOffsetExp> to = <dest_heightOffsetExp> basedOn = <lerping_factor> lowerBound = 0.0 upperBound = 1.0
			next_heightOffsetExp = <result>
			calculate_y_pos_factor_from_lerp_factor lerping_factor = <lerping_factor>
			FastLinearMap from = <start_y_pos> to = <dest_y_pos> basedOn = <y_pos_factor> lowerBound = 0.0 upperBound = 1.0
			next_y_pos = <result>
			target_struct_eof0 = 0.0
			target_struct_eof1 = 0.0
			target_struct_eof2 = 0.0
			target_struct_eof3 = 0.0
			target_struct_eof0 = ((($highway_scale_chart) [0]).extra_offset_factor)
			target_struct_eof1 = ((($highway_scale_chart) [1]).extra_offset_factor)
			target_struct_eof2 = ((($highway_scale_chart) [2]).extra_offset_factor)
			target_struct_eof3 = ((($highway_scale_chart) [3]).extra_offset_factor)
			target_player_morph0 = 0
			target_player_morph1 = 1
			target_player_morph_eof0 = <target_struct_eof0>
			target_player_morph_eof1 = <target_struct_eof1>
			if (<next_extra_offset_factor> <= (<target_struct_eof1>))
				if (<next_extra_offset_factor> <= (<target_struct_eof2>))
					<target_player_morph0> = 2
					<target_player_morph1> = 3
					<target_player_morph_eof0> = <target_struct_eof2>
					<target_player_morph_eof1> = <target_struct_eof3>
				else
					<target_player_morph0> = 1
					<target_player_morph1> = 2
					<target_player_morph_eof0> = <target_struct_eof1>
					<target_player_morph_eof1> = <target_struct_eof2>
				endif
			endif
			target_player_morph_lerp_val = ((<next_extra_offset_factor> - <target_player_morph_eof0>) / (<target_player_morph_eof1> - <target_player_morph_eof0>))
			if (<changed> = true)
				update_highway_scale {
					player = <player>
					x_scale_factor = <next_x_scale>
					y_scale_factor = <next_y_scale>
					extra_offset_factor = <next_extra_offset_factor>
					heightOffsetFactor = <next_heightOffsetFactor>
					heightOffsetExp = <next_heightOffsetExp>
					jamroom_highway = <jamroom_highway>
					lerping_factor = <lerping_factor>
					target_player_morph0 = <target_player_morph0>
					target_player_morph1 = <target_player_morph1>
					target_player_morph_lerp_val = <target_player_morph_lerp_val>
				}
				<objID> :SetTags {
					lerping_factor = <lerping_factor>
					curr_x_scale = <next_x_scale>
					curr_y_scale = <next_y_scale>
					curr_extra_offset_factor = <next_extra_offset_factor>
					curr_heightOffsetFactor = <next_heightOffsetFactor>
					curr_heightOffsetExp = <next_heightOffsetExp>
				}
				next_pos = (((1.0, 0.0) * <next_x_pos>) + ((0.0, 1.0) * <next_y_pos>))
				<objID> :SE_SetProps Pos = <next_pos>
				<objID> :SetTags curr_x_pos = <next_x_pos> curr_y_pos = <next_y_pos>
				hud_next_pos = ((1.0, 0.0) * <next_x_pos>)
				pos_highway_hud player = <player> Pos = <hud_next_pos>
			endif
		endif
	endif
	wait \{1
		gameframe}
	repeat
endscript

script vocalist_scale_manager 
	Obj_GetID
	begin
	if <objID> :GetSingleTag lerping_factor
		if NOT (<lerping_factor> = 1.0)
			<objID> :GetTags
			update_highway_value dest = 1 curr = <lerping_factor> max_delta = ($delta_lerp)
			lerping_factor = <next>
			LinearMap result = next_x_pos from = <start_x_pos> to = <dest_x_pos> basedOn = <lerping_factor> lowerBound = 0 upperBound = 1
			if (<changed> = true)
				GetScreenElementPosition id = <objID>
				next_pos = ((1.0, 0.0) * <next_x_pos>)
				<objID> :SE_SetProps Pos = <next_pos>
				<objID> :SetTags {
					curr_x_pos = <next_x_pos>
					lerping_factor = <lerping_factor>
				}
			endif
		endif
	endif
	wait \{1
		gameframe}
	repeat
endscript

script get_highway_curr_x_scale \{player = 1}
	ExtendedChecksum = null
	ExtendCRCWithInteger checksum = highway_containerp integer = <player>
	hw_container_id = <ExtendedChecksum>
	x_scale = 1.0
	y_scale = 1.0
	if ScreenElementExists id = <hw_container_id>
		curr_x_scale = 1.0
		curr_y_scale = 1.0
		<hw_container_id> :GetTags
		<x_scale> = <curr_x_scale>
		<y_scale> = <curr_y_scale>
	endif
	return curr_x_scale = <x_scale> curr_y_scale = <y_scale>
endscript

script adjust_highway_rails_to_scale \{player = 1}
	max_offset = 37.0
	curr_x_scale = 0.0
	maxxscale = 0.0
	minxscale = 0.0
	ExtendedChecksum = null
	get_highway_curr_x_scale player = <player>
	highway_scale_chart = ($highway_scale_chart)
	maxxscale = (<highway_scale_chart> [0].hw_x_scale)
	minxscale = (<highway_scale_chart> [3].hw_x_scale)
	Range = (<maxxscale> - <minxscale>)
	diff = (<curr_x_scale> - <minxscale>)
	perc = (<diff> / <Range>)
	perc1 = (1.0 - <perc>)
	curr_y_offset = (<perc1> * <max_offset>)
	new_pos = ((2.0, 0.0) + ((0.0, 1.0) * <curr_y_offset>))
	ExtendCRCWithInteger checksum = sidebar_leftp integer = <player>
	name = <ExtendedChecksum>
	if ScreenElementExists id = <name>
		<name> :SE_SetProps Pos = <new_pos>
	endif
	ExtendCRCWithInteger checksum = sidebar_rightp integer = <player>
	name = <ExtendedChecksum>
	new_pos = ((-1.0, 0.0) + ((0.0, 1.0) * <curr_y_offset>))
	if ScreenElementExists id = <name>
		<name> :SE_SetProps Pos = <new_pos>
	endif
endscript

script GetCurrentYPosAndScale \{player = 1}
	ExtendedChecksum = null
	curr_y_pos = 0.0
	curr_y_scale = 0.0
	ExtendCRCWithInteger checksum = highway_containerp integer = <player>
	<ExtendedChecksum> :GetSingleTag curr_y_pos
	<ExtendedChecksum> :GetSingleTag curr_y_scale
	return curr_y_pos = <curr_y_pos> curr_y_scale = <curr_y_scale>
endscript

script update_fade_point \{player = 1
		offset = (0.0, 0.0)
		got_offset = 0}
	pos_table = {}
	curr_y_pos = 0.0
	curr_y_scale = 0.0
	fe = 0.0
	fs = 0.0
	GameMode_GetType
	if (<type> = freeplay)
		<pos_index> = (<player> -1)
		<pos_table> = ($highway_pos_table [<pos_index>])
		GetCurrentYPosAndScale player = <player>
		fe = ((<pos_table>.highway_playline) - ((<pos_table>.highway_height) * <curr_y_scale>))
		fs = (<fe> + ((<pos_table>.highway_fade) * <curr_y_scale>))
		fe = (<fe> + <curr_y_pos>)
		fs = (<fs> + <curr_y_pos>)
		SetHighwayFadeParams topFade = <fe> bottomFade = <fs> player = <player>
	endif
	if (<got_offset> = 1)
		<pos_index> = (<player> -1)
		<pos_table> = ($highway_pos_table [<pos_index>])
		GetCurrentYPosAndScale player = <player>
		fe = ((<pos_table>.highway_playline) - ((<pos_table>.highway_height) * <curr_y_scale>))
		fs = (<fe> + ((<pos_table>.highway_fade) * <curr_y_scale>))
		fe = (<fe> + (<offset>.(0.0, 1.0)))
		fs = (<fs> + (<offset>.(0.0, 1.0)))
		SetHighwayFadeParams topFade = <fe> bottomFade = <fs> player = <player>
	endif
endscript
