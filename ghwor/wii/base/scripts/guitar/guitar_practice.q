Practice_NoteMapping = [
	{
		MidiNote = 60
		Scr = play_drum_sample
		params = {
			pad = kick
			buss = drums_practicemode_kick
		}
	}
	{
		MidiNote = 61
		Scr = play_drum_sample
		params = {
			pad = tom2
			buss = drums_practicemode_toms
		}
	}
	{
		MidiNote = 62
		Scr = play_drum_sample
		params = {
			pad = tom2
			buss = drums_practicemode_toms
		}
	}
	{
		MidiNote = 63
		Scr = play_drum_sample
		params = {
			pad = tom1
			buss = drums_practicemode_toms
		}
	}
	{
		MidiNote = 64
		Scr = play_drum_sample
		params = {
			pad = snare
			buss = drums_practicemode_snare
		}
	}
	{
		MidiNote = 65
		Scr = audio_gameplay_practice_play_project_dependent_drum_sample
		params = {
			pad = hihat
			buss = drums_practicemode_cymbals_hats
			MidiNote = 65
			sfxtype = hihatclosed
		}
	}
	{
		MidiNote = 66
		Scr = audio_gameplay_practice_play_project_dependent_drum_sample
		params = {
			pad = hihat
			buss = drums_practicemode_cymbals_hats
			MidiNote = 66
			sfxtype = hihatopen
		}
	}
	{
		MidiNote = 67
		Scr = audio_gameplay_practice_play_project_dependent_drum_sample
		params = {
			pad = cymbal
			buss = drums_practicemode_cymbals_crash
			MidiNote = 67
			sfxtype = ride
		}
	}
	{
		MidiNote = 68
		Scr = audio_gameplay_practice_play_project_dependent_drum_sample
		params = {
			pad = cymbal
			buss = drums_practicemode_cymbals_crash
			MidiNote = 68
			sfxtype = crash1
		}
	}
	{
		MidiNote = 69
		Scr = audio_gameplay_practice_play_project_dependent_drum_sample
		params = {
			pad = cymbal
			buss = drums_practicemode_cymbals_crash
			MidiNote = 69
			sfxtype = crash2
		}
	}
	{
		MidiNote = 86
		Scr = audio_gameplay_practice_play_project_dependent_drum_sample
		params = {
			pad = kick
			sfxtype = kick
			buss = drums_practicemode_kick
		}
	}
	{
		MidiNote = 87
		Scr = audio_gameplay_practice_play_project_dependent_drum_sample
		params = {
			pad = tom2
			sfxtype = fltom2
			buss = drums_practicemode_toms
		}
	}
	{
		MidiNote = 88
		Scr = audio_gameplay_practice_play_project_dependent_drum_sample
		params = {
			pad = tom2
			sfxtype = fltom1
			buss = drums_practicemode_toms
		}
	}
	{
		MidiNote = 89
		Scr = audio_gameplay_practice_play_project_dependent_drum_sample
		params = {
			pad = tom2
			sfxtype = tom2
			buss = drums_practicemode_toms
		}
	}
	{
		MidiNote = 90
		Scr = audio_gameplay_practice_play_project_dependent_drum_sample
		params = {
			pad = tom1
			sfxtype = tom1
			buss = drums_practicemode_toms
		}
	}
	{
		MidiNote = 91
		Scr = audio_gameplay_practice_play_project_dependent_drum_sample
		params = {
			pad = snare
			sfxtype = snare
			buss = drums_practicemode_snare
		}
	}
	{
		MidiNote = 92
		Scr = audio_gameplay_practice_play_project_dependent_drum_sample
		params = {
			pad = snare
			sfxtype = snareghost
			buss = drums_practicemode_snare
		}
	}
	{
		MidiNote = 93
		Scr = audio_gameplay_practice_play_project_dependent_drum_sample
		params = {
			pad = snare
			sfxtype = snareflam
			buss = drums_practicemode_snare
		}
	}
	{
		MidiNote = 94
		Scr = audio_gameplay_practice_play_project_dependent_drum_sample
		params = {
			pad = snare
			sfxtype = snarecrossstick
			buss = drums_practicemode_snare
		}
	}
	{
		MidiNote = 95
		Scr = audio_gameplay_practice_play_project_dependent_drum_sample
		params = {
			pad = hihat
			sfxtype = hihatclosed
			buss = drums_practicemode_cymbals_hats
		}
	}
	{
		MidiNote = 96
		Scr = audio_gameplay_practice_play_project_dependent_drum_sample
		params = {
			pad = hihat
			sfxtype = hihatopen
			buss = drums_practicemode_cymbals_hats
		}
	}
	{
		MidiNote = 97
		Scr = audio_gameplay_practice_play_project_dependent_drum_sample
		params = {
			pad = hihat
			sfxtype = cowbell
			buss = drums_practicemode_cymbals_crash
		}
	}
	{
		MidiNote = 98
		Scr = audio_gameplay_practice_play_project_dependent_drum_sample
		params = {
			pad = cymbal
			sfxtype = ride
			buss = drums_practicemode_cymbals_crash
		}
	}
	{
		MidiNote = 99
		Scr = audio_gameplay_practice_play_project_dependent_drum_sample
		params = {
			pad = cymbal
			sfxtype = ridebell
			buss = drums_practicemode_cymbals_crash
		}
	}
	{
		MidiNote = 100
		Scr = audio_gameplay_practice_play_project_dependent_drum_sample
		params = {
			pad = cymbal
			sfxtype = crash1
			buss = drums_practicemode_cymbals_crash
		}
	}
	{
		MidiNote = 101
		Scr = audio_gameplay_practice_play_project_dependent_drum_sample
		params = {
			pad = cymbal
			sfxtype = crash2
			buss = drums_practicemode_cymbals_crash
		}
	}
	{
		MidiNote = 102
		Scr = audio_gameplay_practice_play_project_dependent_drum_sample
		params = {
			pad = cymbal
			sfxtype = crash3
			buss = drums_practicemode_cymbals_crash
		}
	}
	{
		MidiNote = 103
		Scr = audio_gameplay_practice_play_project_dependent_drum_sample
		params = {
			pad = cymbal
			sfxtype = splash
			buss = drums_practicemode_cymbals_crash
		}
	}
	{
		MidiNote = 104
		Scr = audio_gameplay_practice_play_project_dependent_drum_sample
		params = {
			pad = cymbal
			sfxtype = china
			buss = drums_practicemode_cymbals_crash
		}
	}
	{
		MidiNote = 105
		Scr = audio_gameplay_practice_play_project_dependent_drum_sample
		params = {
			pad = cymbal
			sfxtype = cymbalchoke1
			buss = drums_practicemode_cymbals_crash
		}
	}
	{
		MidiNote = 106
		Scr = audio_gameplay_practice_play_project_dependent_drum_sample
		params = {
			pad = cymbal
			sfxtype = cymbalchoke2
			buss = drums_practicemode_cymbals_crash
		}
	}
	{
		MidiNote = 107
		Scr = audio_gameplay_practice_play_project_dependent_drum_sample
		params = {
			pad = cymbal
			sfxtype = cymbalchoke3
			buss = drums_practicemode_cymbals_crash
		}
	}
]
practice_slomo_drum_notemapping = [
	{
		MidiNote = 60
		Scr = play_drum_sample
		params = {
			pad = kick
			buss = drums_ingame_kick
		}
	}
	{
		MidiNote = 61
		Scr = play_drum_sample
		params = {
			pad = tom2
			buss = drums_ingame_toms
		}
	}
	{
		MidiNote = 62
		Scr = play_drum_sample
		params = {
			pad = tom2
			buss = drums_ingame_toms
		}
	}
	{
		MidiNote = 63
		Scr = play_drum_sample
		params = {
			pad = tom1
			buss = drums_ingame_toms
		}
	}
	{
		MidiNote = 64
		Scr = play_drum_sample
		params = {
			pad = snare
			buss = drums_ingame_snare
		}
	}
	{
		MidiNote = 65
		Scr = play_drum_sample
		params = {
			pad = hihat
			buss = drums_ingame_hats
			velocity = 50
		}
	}
	{
		MidiNote = 66
		Scr = play_drum_sample
		params = {
			pad = hihat
			buss = drums_ingame_hats
		}
	}
	{
		MidiNote = 67
		Scr = play_drum_sample
		params = {
			pad = cymbal
			buss = drums_ingame_cymbals
			velocity = 50
		}
	}
	{
		MidiNote = 68
		Scr = play_drum_sample
		params = {
			pad = cymbal
			buss = drums_ingame_cymbals
		}
	}
	{
		MidiNote = 69
		Scr = play_drum_sample
		params = {
			pad = cymbal
			buss = drums_ingame_cymbals
			velocity = 90
		}
	}
	{
		MidiNote = 86
		Scr = audio_gameplay_practice_play_project_dependent_drum_sample
		params = {
			pad = kick
			sfxtype = kick
			buss = drums_ingame_kick
		}
	}
	{
		MidiNote = 87
		Scr = audio_gameplay_practice_play_project_dependent_drum_sample
		params = {
			pad = tom2
			sfxtype = fltom2
			buss = drums_ingame_toms
		}
	}
	{
		MidiNote = 88
		Scr = audio_gameplay_practice_play_project_dependent_drum_sample
		params = {
			pad = tom2
			sfxtype = fltom1
			buss = drums_ingame_toms
		}
	}
	{
		MidiNote = 89
		Scr = audio_gameplay_practice_play_project_dependent_drum_sample
		params = {
			pad = tom2
			sfxtype = tom2
			buss = drums_ingame_toms
		}
	}
	{
		MidiNote = 90
		Scr = audio_gameplay_practice_play_project_dependent_drum_sample
		params = {
			pad = tom1
			sfxtype = tom1
			buss = drums_ingame_toms
		}
	}
	{
		MidiNote = 91
		Scr = audio_gameplay_practice_play_project_dependent_drum_sample
		params = {
			pad = snare
			sfxtype = snare
			buss = drums_ingame_snare
		}
	}
	{
		MidiNote = 92
		Scr = audio_gameplay_practice_play_project_dependent_drum_sample
		params = {
			pad = snare
			sfxtype = snareghost
			buss = drums_ingame_snare
		}
	}
	{
		MidiNote = 93
		Scr = audio_gameplay_practice_play_project_dependent_drum_sample
		params = {
			pad = snare
			sfxtype = snareflam
			buss = drums_ingame_snare
		}
	}
	{
		MidiNote = 94
		Scr = audio_gameplay_practice_play_project_dependent_drum_sample
		params = {
			pad = snare
			sfxtype = snarecrossstick
			buss = drums_ingame_snare
		}
	}
	{
		MidiNote = 95
		Scr = audio_gameplay_practice_play_project_dependent_drum_sample
		params = {
			pad = hihat
			sfxtype = hihatclosed
			buss = drums_ingame_hats
		}
	}
	{
		MidiNote = 96
		Scr = audio_gameplay_practice_play_project_dependent_drum_sample
		params = {
			pad = hihat
			sfxtype = hihatopen
			buss = drums_ingame_hats
		}
	}
	{
		MidiNote = 97
		Scr = audio_gameplay_practice_play_project_dependent_drum_sample
		params = {
			pad = hihat
			sfxtype = cowbell
			buss = drums_ingame_cymbals
		}
	}
	{
		MidiNote = 98
		Scr = audio_gameplay_practice_play_project_dependent_drum_sample
		params = {
			pad = cymbal
			sfxtype = ride
			buss = drums_ingame_cymbals
		}
	}
	{
		MidiNote = 99
		Scr = audio_gameplay_practice_play_project_dependent_drum_sample
		params = {
			pad = cymbal
			sfxtype = ridebell
			buss = drums_ingame_cymbals
		}
	}
	{
		MidiNote = 100
		Scr = audio_gameplay_practice_play_project_dependent_drum_sample
		params = {
			pad = cymbal
			sfxtype = crash1
			buss = drums_ingame_cymbals
		}
	}
	{
		MidiNote = 101
		Scr = audio_gameplay_practice_play_project_dependent_drum_sample
		params = {
			pad = cymbal
			sfxtype = crash2
			buss = drums_ingame_cymbals
		}
	}
	{
		MidiNote = 102
		Scr = audio_gameplay_practice_play_project_dependent_drum_sample
		params = {
			pad = cymbal
			sfxtype = crash3
			buss = drums_ingame_cymbals
		}
	}
	{
		MidiNote = 103
		Scr = audio_gameplay_practice_play_project_dependent_drum_sample
		params = {
			pad = cymbal
			sfxtype = splash
			buss = drums_ingame_cymbals
		}
	}
	{
		MidiNote = 104
		Scr = audio_gameplay_practice_play_project_dependent_drum_sample
		params = {
			pad = cymbal
			sfxtype = china
			buss = drums_ingame_cymbals
		}
	}
	{
		MidiNote = 105
		Scr = audio_gameplay_practice_play_project_dependent_drum_sample
		params = {
			pad = cymbal
			sfxtype = cymbalchoke1
			buss = drums_ingame_cymbals
		}
	}
	{
		MidiNote = 106
		Scr = audio_gameplay_practice_play_project_dependent_drum_sample
		params = {
			pad = cymbal
			sfxtype = cymbalchoke2
			buss = drums_ingame_cymbals
		}
	}
	{
		MidiNote = 107
		Scr = audio_gameplay_practice_play_project_dependent_drum_sample
		params = {
			pad = cymbal
			sfxtype = cymbalchoke3
			buss = drums_ingame_cymbals
		}
	}
]
practice_current_percentage = 0
practice_highest_percentage = 0

script practice_setup_notemappings 
	if NOT ($current_speedfactor = 1.0)
		if NOT playerinfoequals \{1
				part = drum}
			SetNoteMappings \{section = drums
				mapping = $Practice_NoteMapping}
		else
			SetNoteMappings \{section = drums
				mapping = $practice_slomo_drum_notemapping}
		endif
	endif
endscript
practice_font = fontgrid_title_a1

script practicemode_init 
	printf \{channel = sfx
		qs(0x57d2e106)}
	destroyeffectsendstack slot = ($venue_sendeffect_slot)
	Change \{practice_current_percentage = 0}
	Change \{practice_highest_percentage = 0}
	practice_setup_notemappings
	playlist_getcurrentsong
	loaddrumkitall song = <current_song> practice_percussion = 1 async = 0
	prepare_band_for_main_menu
	Hide_Band
	CreateScreenElement \{Type = ContainerElement
		parent = root_window
		id = practice_container
		Pos = (0.0, 0.0)}
	CreateScreenElement \{Type = descinterface
		desc = 'practice_section_text'
		parent = practice_container
		id = practice_sectiontext
		text_alpha = 0}
	text_pos = (400.0, 400.0)
	getplayerinfo \{1
		part}
	if (<part> = vocals)
		text_pos = (400.0, 360.0)
	endif
	CreateScreenElement {
		Type = TextElement
		parent = practice_container
		id = practice_sectionpercentagetext
		Scale = (0.8, 0.75)
		Pos = <text_pos>
		font = ($practice_font)
		rgba = [255 255 255 255]
		alpha = 1
		just = [right top]
		z_priority = 3
		text = qs(0xf816244e)
	}
	CreateScreenElement {
		Type = TextElement
		parent = practice_container
		id = practice_sectionpercentagetext_highest
		Scale = (0.33, 0.33)
		Pos = (<text_pos> + (0.0, 66.0))
		font = ($practice_font)
		rgba = [255 255 255 255]
		alpha = 0
		just = [right top]
		z_priority = 3
		text = qs(0xf816244e)
	}
	SpawnScriptNow \{practicemode_section}
	Change \{disable_crowd = 0}
	crowd_models = $crowd_model_array
	if (<crowd_models> = None)
		create_crowd_models
	endif
	hide_crowd_models
	Change \{disable_crowd = 1}
endscript

script practicemode_section 
	audio_practice_fade_in_drums
	getfirstplayer
	if playerinfoequals <Player> part = vocals
		return
	endif
	current_section_index = 0
	begin
	GetSongTimeMs
	if (<time> > $current_starttime)
		practice_sectiontext :se_setprops section_text = ($current_section_array [($current_section_array_entry)].marker)
		practice_sectiontext :se_setprops \{text_alpha = 1.0
			time = 0.5}
		current_section_index = ($current_section_array_entry)
		break
	endif
	Wait \{1
		gameframe}
	repeat
	begin
	GetSongTimeMs
	if (<time> > $current_endtime)
		practice_sectiontext :se_setprops \{text_alpha = 0.0
			time = 0.5}
		audio_practice_fade_out_drums
		break
	elseif NOT (<current_section_index> = ($current_section_array_entry))
		practice_sectiontext :se_setprops \{text_alpha = 0.0
			time = 0.5}
		Wait \{0.5
			Second}
		practice_sectiontext :se_setprops section_text = ($current_section_array [($current_section_array_entry)].marker)
		practice_sectiontext :se_setprops \{text_alpha = 1.0
			time = 0.5}
		current_section_index = ($current_section_array_entry)
	endif
	Wait \{1
		gameframe}
	repeat
endscript

script practicemode_deinit 
	hide_glitch \{num_frames = 5}
	printf \{channel = sfx
		qs(0x933ce655)}
	audio_effects_create_settings_by_venue
	ClearNoteMappings \{section = practice}
	KillSpawnedScript \{Name = practicemode_section}
	if ScreenElementExists \{id = practice_container}
		DestroyScreenElement \{id = practice_container}
	endif
	StopSoundsByBuss \{practicemode_drums}
	Unhide_Band
	i = 1
	begin
	formatText checksumName = Name 'musician%i' i = <i>
	if CompositeObjectExists <Name>
		<Name> :Unpause
	endif
	repeat 4
	hide_crowd_models \{Active = FALSE}
endscript

script reset_practice_mode 
	kill_practice_scripts
	end_practice_song_slomo
	practicemode_deinit
	enable_crowd_models_cfunc \{Active = true}
	Change \{disable_crowd = 0}
	Change \{practice_start_time = 0}
	Change \{practice_end_time = 0}
	Change \{current_starttime = 0}
endscript
